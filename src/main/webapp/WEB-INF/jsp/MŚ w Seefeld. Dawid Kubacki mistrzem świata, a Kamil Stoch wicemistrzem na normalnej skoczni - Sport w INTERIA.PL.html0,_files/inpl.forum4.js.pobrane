!function(){function a(a,b){function c(a){return e.apiUrl+e.serviceList[a]}var d={apiUrl:"/api-forum-4",apiVersion:1,serviceList:{getCommentList:"/comment-list/",getCommentReplyList:"/comment-list/",addAttachmentList:"/comment-attachments/",promote:"/comment-promote/",addComment:"/comment-save/",abuse:"/comment-abuse/",voteup:"/comment-up/",votedown:"/comment-down/",tokenCsrf:"/comment-csrf/",checkAllowPostDelete:"/comment-user-priv/",deleteComment:"/comment-delete/"},timeoutms:3e4},e=u(d,b);return T.setDefaultOptions({timeout:e.timeoutms}),{getCommentList:function(b,d,f,g,h){return T.get(c("getCommentList"),{v:e.apiVersion,objectId:a.getObjectId(),objectType:a.getObjectType(),pageNumber:b,filterValue:d,sortValue:f,commentId:g,nocache:Math.floor(Math.random()*Date.now()),packSize:h},{withCredentials:!0,responseType:"json"})},getCommentReplyList:function(b,d,f,g,h){var i={v:e.apiVersion,objectId:a.getObjectId(),objectType:a.getObjectType(),pageNumber:b,filterValue:d,sortValue:f,parentCommentId:g};return h&&(i._antycache=h),T.get(c("getCommentReplyList"),i,{cache:!0,withCredentials:!0,responseType:"json"})},addAttachmentList:function(b){return T.post(c("addAttachmentList"),{v:e.apiVersion,token:a.getToken(),ts:a.getTokenTimestamp(),objectId:a.getObjectId(),objectType:a.getObjectType(),attachmentList:b},{withCredentials:!0,responseType:"json"})},addComment:function(b,d,f,g,h,i){return T.post(c("addComment"),{v:e.apiVersion,objectId:a.getObjectId(),objectType:a.getObjectType(),csrfToken:b,authorNick:d.getNick(),parentCommentId:f,commentContent:g,attachmentList:h,reCaptchaToken:i},{withCredentials:!0,responseType:"json"})},promote:function(b,d,f){return T.post(c("promote"),{v:e.apiVersion,objectId:a.getObjectId(),objectType:a.getObjectType(),csrfToken:b,commentId:d,smsCode:f},{withCredentials:!0,responseType:"json"})},abuse:function(b,d,f,g,h,i){return T.post(c("abuse"),{v:e.apiVersion,objectId:a.getObjectId(),objectType:a.getObjectType(),csrfToken:b,commentId:d,captchaId:f,captchaValue:g,reason:h,application:i},{withCredentials:!0,responseType:"json"})},voteup:function(b,d){return T.post(c("voteup"),{v:e.apiVersion,objectId:a.getObjectId(),objectType:a.getObjectType(),csrfToken:b,commentId:d},{withCredentials:!0,responseType:"json"})},votedown:function(b,d){return T.post(c("votedown"),{v:e.apiVersion,objectId:a.getObjectId(),objectType:a.getObjectType(),csrfToken:b,commentId:d},{withCredentials:!0,responseType:"json"})},getCsrfToken:function(b){return T.post(c("tokenCsrf"),{v:e.apiVersion,objectId:a.getObjectId(),objectType:a.getObjectType(),commentId:b},{cache:!0,withCredentials:!0,responseType:"json"})},checkAllowPostDelete:function(){return T.post(c("checkAllowPostDelete"),{},{cache:!0,withCredentials:!0,responseType:"json"})},deleteComment:function(a,b){return T.post(c("deleteComment"),{csrfToken:a,commentId:b},{cache:!0,withCredentials:!0,responseType:"json"})}}}function b(a){function b(a){return f.apiUrl+f.serviceList[a]}function c(a,b,c){var d,e=Math.floor(9999999*Math.random()),f="jsonp_forum4_captcha_"+e;window[f]=function(a,c){c?b.call(null,null,c):b.call(null,a,null),delete window[f]},setTimeout(function(){window[f]&&window[f](null,"Przekroczono czas oczekiwania na odpowiedź"),window[f]=function(){}},c||3e4),d=l("script",null,null,{src:a+"&callback="+f}),m(document.head,d)}function d(a,d){c(b("getEnigmaJS")+"?ctime="+f.ctime+"&type="+f.type,a,d)}var e={apiUrl:null,ctime:960,type:1,serviceList:{getEnigmaJS:"/getEnigmaJS"}},f=u(e,a);return{getCaptcha:d}}function c(){var a=this;this._namespace="go-recaptcha",this._config=!1,this._id=null,this._dom=null,this._forum=null,this._result={},this.instanceCnt=0,this.wasShow=!1,this._defaults={size:"normal",urlApi:{library:"//www.google.com/recaptcha/api.js",verify:"/api-forum-4/comment-recaptcha-verify"},callback:{upload:"reCaptchaCallbackUpload",verify:"reCaptchaCallbackVerify",expired:"reCaptchaCallbackExpired"}},window.reCaptchaCallbackUpload=function(){if(void 0!==window.grecaptcha)try{a._id=window.grecaptcha.render(a.getNamespace(),{sitekey:a._config.siteKey,callback:a._config.callback.verify,"expired-callback":a._config.callback.expired,size:a._config.size})}catch(b){}},window.reCaptchaCallbackExpired=function(){a._result={}},window.reCaptchaCallbackVerify=function(b){if("string"==typeof b&&b.length&&(a._result.token=b,T.post(a._config.urlApi.verify,{reCaptchaToken:b},{withCredentials:!0,responseType:"json"}).then(function(b,c){a._result.calculate=!!(c&&c.result&&c.result.isRunning)}).catch(function(a){}),a._forum.dom.formAdd&&void 0!==a._forum.dom.formAdd.getBoundingClientRect)){var c=O.getScrollPosition()+a._forum.dom.formAdd.getBoundingClientRect().top-50;O.scrollToPosition(c)}}}function d(a,b,c){return{makeUrl:function(d,e,f){var g,h="C0",i=0,j=b[a.getActualCssClassIndex()].from,k=null;for(g=0;g<b.length;g+=1)b[g].from<=j&&b[g].from>=i&&f.hasOwnProperty(b[g].name)&&(k=g,i=b[g].from);return null!==k&&(h=f[b[k].name]),"//"+c+"/"+d+"-"+h+"."+e}}}function e(a,b,c){b=b&&b%1==0?b:500;var d,e;return function(){var f=c||this,g=+new Date,h=arguments;d&&g<d+b?(clearTimeout(e),e=setTimeout(function(){d=g,a.apply(f,h)},b)):(d=g,a.apply(f,h))}}function f(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}function g(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>-1}function h(a,b){return g(a,b)||(a.className+=(a.className?" ":"")+b),a}function j(a,b){for(var c=" "+a.className+" ";c.indexOf(" "+b+" ")>-1;)c=c.replace(" "+b+" "," ");return a.className="function"==typeof c.trim?c.trim():c.replace(/^\s+|\s+$/g,""),a}function k(a,b){g(a,b)?j(a,b):h(a,b)}function l(a,b,c,d){var e=document.createElement(a);return void 0!==b&&null!==b&&(e.className=b),void 0!==c&&null!==c&&(e.innerHTML=c),"object"==typeof d&&Object.keys(d).forEach(function(a,b){d.hasOwnProperty(a)&&e.setAttribute(a,d[a])}),e}function m(a,b){if(arguments.length>2)Array.prototype.forEach.call(arguments,function(b,c){c<1||null===b||(v(b)?b.forEach(function(b){null!==b&&a.appendChild(b)}):a.appendChild(b))});else{if(null===b)return a;v(b)?b.forEach(function(b){null!==b&&a.appendChild(b)}):a.appendChild(b)}return a}function n(a,b,c){b.indexOf(" ")>-1?b.split(" ").forEach(function(b){a.addEventListener(b,c)}):a.addEventListener(b,c)}function o(a,b,c){a.removeEventListener(b,c)}function p(a,b){return a.parentNode.replaceChild(b,a),b}function q(){return"innerHeight"in window?[window.innerHeight,window.innerWidth]:[640,480]}function r(){return q()[1]<768}function s(a){"function"!=typeof gemius_hit?(new Image).src=location.protocol+"//interia.hit.gemius.pl/_"+(new Date).getTime()+"/redot.gif?id="+a:gemius_hit(a)}function t(a,b){var c=a?"app":"www";N[c].hasOwnProperty(b)&&s(N[c][b])}function u(a,b){var c,d=[].slice.call(arguments),e="boolean"==typeof d[0]&&d.shift(),f=d[0],g=d.slice(1),h=g.length;for(c=0;c<h;c+=1){var i=g[c];for(var j in i){var k=i[j];if(e&&k&&"object"==typeof k){var l=Array.isArray(k)?[]:{};f[j]=u(!0,l,k)}else f[j]=k}}return f}function v(a){return Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a)}function w(a,b){return void 0===a?b:a}function x(a){function b(b){if(d&&-1===a.indexOf(b)){throw"["+(this.constructor.name||"MixinEvents")+"]: event o nazwie ["+b+"] jest niedozwolony, dozwolone to ["+a.join(",")+"]"}}function c(a,c,d){switch(b.call(this,c),a){case"on":this._eventshandlers=this._eventshandlers||{},this._eventshandlers[c]=this._eventshandlers[c]||[],this._eventshandlers[c].push(d);break;case"one":this._eventshandlersone=this._eventshandlersone||{},this._eventshandlersone[c]=this._eventshandlersone[c]||[],this._eventshandlersone[c].push(d)}}var d=void 0!==a;return{on:function(a,b){c.call(this,"on",a,b)},one:function(a,b){c.call(this,"one",a,b)},off:function(a,c){var d,e;b.call(this,a),c?(this._eventshandlers&&this._eventshandlers[a]&&-1!==(d=this._eventshandlers[a].indexOf(c))&&this._eventshandlers[a].splice(d,1),this._eventshandlersone&&this._eventshandlersone[a]&&-1!==(e=this._eventshandlersone[a].indexOf(c))&&this._eventshandlersone[a].splice(e,1)):(this._eventshandlers[a]=[],this._eventshandlersone[a]=[])},fire:function(a){var c,d,e;if(b.call(this,a),this._eventshandlers&&this._eventshandlers[a])for(d=this._eventshandlers[a],c=0;c<d.length;c++)d[c].apply(this,Array.prototype.slice.call(arguments,1));if(this._eventshandlersone&&this._eventshandlersone[a])for(e=this._eventshandlersone[a],c=0;c<e.length;c+=1)"function"==typeof e[c]&&(e[c].apply(this,Array.prototype.slice.call(arguments,1)),e[c]=null)}}}function y(a){this._attachment=a,this.settings={layerMargin:10},this.dom={instance:null,inside:null,content:null,iframe:null,ratio:null}}function z(a){this._attachment=a,this.settings={layerMargin:10},this.dom={instance:null,inside:null,content:null,imageNode:null}}function A(a,b){this._forum=a,this._attachment=b,this._elementInstance=null,this.dom={instance:null,closeButton:null}}function B(a,b,c){this._forum=a,this._comment=b,this._id=c.id,this._nick=c.nick,this._avatarId=c.avatarId,this._avatarExtension=c.avatarExtension,this._profileUrl=w(c.profileUrl,null)}function C(a,b,c,d){this._forum=a,this._user=b,this._mainLevelComment=w(d,null),this._authorData=c.author,this._author=null,this._id=c.id,this._datetime=c.datetime,this._dateText=c.dateText,this._content=c.content,this._premiumCount=c.premiumCount,this._voteup=c.voteup,this._votedown=c.votedown,this._replyCount=c.replyCount,this._parentAuthor=c.parentAuthor,this._parentCommentId=c.parentCommentId,this._attachmentListData=c.attachmentList,this._formAdd=null,this._formAbuse=null,this._formPremium=null,this._commentList=[],this._pageCount=null,this._voteStatus=c.voteStatus,this._loadReplyPromise=null,this.dom={instance:null,block:null,repliesShowButton:null,commentReplyMoreButton:null,replyList:null,actionPromoteButton:null,actionVoteupButton:null,actionVotedownButton:null,actionReplyButton:null,optionLink:null,optionLinkblock:null,optionLinkClose:null,optionLinkInput:null,optionAbuse:null,formAdd:null,formAbuse:null,formPremium:null},this._attachmentList=[]}function D(a,b){this._comment=a,this._originalUrl=b.originalUrl,this._proxyUrl=b.proxyUrl,this._thumbId=b.thumbId,this._thumbExtension=b.thumbExtension,this._externalThumbUrl=w(b.externalThumbUrl,null),this._type=b.type,this._iframeUrl=w(b.videoEmbedUrl,null),this._layer=null,this.dom={instance:null}}function E(a,b,c){this._forum=a,this._user=b,this._comment=c,this._captchaUid=null,this._captchaApi=null,this.dom={instance:null,content:null,closeButton:null,captchaModule:null,captchaInput:null,captcha:null,captchaRefresh:null,errorMessage:null,reasonTextarea:null,submit:null}}function F(a,b,c){this._forum=a,this._user=b,this._comment=void 0===c?null:c,this._attachmentRequest=null,this._attachmentList=[],this._attachmentMessageText='Wysyłając komentarz jako użytkownik niezalogowany,<br/>akceptujesz niniejszy <a href="http://firma.interia.pl/regulamin#comnt" target="_blank">regulamin</a>.',this._attachmentMessageType="info",this._linkList=[],this._tryNumber=1,this._tryTimer=null,this.dom={instance:null,inside:null,contentInput:null,attachmentMessage:null,attachmentList:null,submit:null,errorMessage:null,inputNick:null,reCaptcha:null}}function G(a,b){this._formAdd=a,this._originalUrl=b,this._notFoundThumb=!1,this.dom={instance:null,removeButton:null}}function H(a,b){this._forum=a,this._comment=b,this.dom={instance:null,content:null,closeButton:null,smsCode:null,submit:null}}function I(a){var b=this,c={placeName:null,containerDom:null,objectId:null,objectType:null,dId:null,portalId:null,profileServiceId:null,mailServiceId:null,loginUrl:null,logoutUrl:null,profileSettingsUrl:null,profileActivateUrl:null,isMobileApp:!1,allowLoginUser:!0,token:null,screenToken:null,tokenTimestamp:null,captchaServiceUrl:null,themeList:[{name:"small",css:"forum--is-small",from:0,pagination:{naviBut:42,pageBut:52,dots:15}},{name:"big",css:"forum--is-big",from:710,pagination:{naviBut:155,pageBut:60,dots:15}}],sort:[{name:"Najnowsze",value:1},{name:"Najstarsze",value:2},{name:"Najlepiej ocenione",value:3},{name:"Wg liczby odp.",value:4}],sortValue:1,filter:[{name:"Wszyscy",value:"all"},{name:"Zalogowani",value:"logged"},{name:"Wyróżnione",value:"promoted"}],filterValue:"all",imageServerHost:"i.iplsc.com",scrollTopOffset:0,packSize:10,dsgUserType:Inpl&&Inpl.dsg&&Inpl.dsg.getUserType?Inpl.dsg.getUserType():""};this._options=a,this.settings=u(c,a),this.dom={instance:null,filterBlock:null,filterToggle:null,filterSelect:null,sortSelect:null,headerLabelCount:null,commentListPremium:null,commentList:null,notFoundComment:null,paginationOld:null,formAdd:null},this._api=null,this._formAdd=null,this._user=null,this._attachmentImage=null,this._actualPageNumber=null,this._commentList=[],this._commentListPremium=[],this._visitingCommentId=null,this._actualThemeIndex=0,this._changePagePromise=[],this._storage=new J(this),this._resizeListener=null,this._scrollListener=null,this.getContainerDom()&&this.getContainerDom().appendChild(this.getInstanceDom()),this._instanceWidth=this.getInstanceWidth(),this.checkSize(),this._renderStructure(),setTimeout(function(){b.changePage(null,b.getCommentIdFromUrl(),!0)},0),this._listenResize(),this._listenScroll(),this._reCaptchaApi=null}function J(a){this._forum=a,this._removeOldData()}function K(a){this._forum=a,this.dom={instance:null,next:null,prev:null,pages:null}}function L(a){this._forum=a,this.parseCookie()}c.prototype=u(c.prototype,{getNamespace:function(){return this._namespace+"-"+this.instanceCnt},setConfig:function(a){if(a){if(this._forum&&this._forum.getInstanceWidth()<=320&&(this._defaults.size="compact"),a=JSON.parse(a),this._config=u(this._defaults,a),this._defaults=null,this._config&&this._config.siteKey&&this._config.siteKey.length>10&&this._config.lang&&"undefined"!==this._config.forLogged)return;throw this._config=!1,new Error("no valid params for reCAPTCHA")}},getConfig:function(){return this._config},setDom:function(a){this._dom=a},setForum:function(a){this._forum=a},isRequired:function(){return this._config&&(!!this._config.forLogged||!this._forum._user.isLogged())},isValid:function(){return!this.isRequired()||!(!this._result.token||!this._result.calculate)},getToken:function(){return void 0!==this._result.token?this._result.token:null},getResult:function(){return result},isRender:function(){return null!==this._id&&this._dom&&this._dom.hasChildNodes()},reload:function(){this._dom.setAttribute("id",this.getNamespace()),this._dom.setAttribute("class",this.getNamespace()),setTimeout(function(){window.reCaptchaCallbackUpload()},20)},init:function(){this.isRequired()&&!this.isRender()&&(this._dom.setAttribute("id",this.getNamespace()),this._dom.setAttribute("class",this.getNamespace()),this._addScriptFile(this._config.urlApi.library+"?hl="+this._config.lang+"&render=explicit&onload="+this._config.callback.upload))},reset:function(){if(void 0!==window.grecaptcha)try{window.grecaptcha.reset(this._id)}catch(a){}else this.init()},getErrorText:function(){return this._config.errorText?this._config.errorText:"pl"==this._config.lang?"Należy rozwiązać poprawnie zadanie reCAPTCHA":"You have to resolve task of Google reCAPTCHA"},show:function(){this._dom&&void 0!==this._dom.parentNode&&(this._dom.parentNode.style.display="block",this.wasShow||(iwa("trackEvent","Komentarze","Recaptcha","View",this.getForum().getDsgUserType()),t(this._forum.isMobileApp(),"recaptcha_view_pierwsza"),this.wasShow=!0))},hide:function(){this._dom&&void 0!==this._dom.parentNode&&(this._dom.parentNode.style.display="none")},success:function(){this._result.token&&this._result.calculate&&(iwa("trackEvent","Komentarze","Recaptcha","rozwiazanie",this.getForum().getDsgUserType()),t(this._forum.isMobileApp(),"recaptcha_rozwiazanie_dodatkowa"),this._result={},this.instanceCnt++)},_addScriptFile:function(a){var b=document.createElement("script"),c=document.getElementsByTagName("script")[0];return b.async=!0,b.src=a,b.defer=!0,c.parentNode.insertBefore(b,c),b}});var M=function(){var a={},b=!1,c=function(){if(!b&&document.cookie){var c,d,e,f;if(f=document.cookie.match(/([^\s;\|][a-zA-Z0-9\_\-\.\%]+)=([^;\s]+)/gi),b=!0,f)for(i=0;i<f.length;i++)(e=f[i].indexOf("="))>0&&(c=f[i].substring(0,e),d=f[i].substring(e+1,f[i].length),c&&d&&(a[c]=d))}},d=function(d){return b||c(),g(d)?a[d]:null},e=function(d){return b||c(),g(d)?parseInt(a[d],10):null},f=function(d){return b||c(),g(d)?decodeURIComponent(a[d]):null},g=function(d){return b||c(),!!(a[d]&&a[d].length>0)};return{getRaw:d,getInt:e,getDecode:f,is:g}}(),N={www:{AddComment:"nc01jXtOuasPgqVDEQeXLKbSXqyU3nseRlbh0SP7EOr.v7",voteup:"B7aVHeOMyewpJi8M2JJ7OIYhnM8plbCZMStW3hnO_qL.s7",votedown:"B7aVHeOMyewpJi8M2JJ7OIYhnM8plbCZMStW3hnO_qL.s7",changePage:"nd.gxHsg4w3qA5s4Zsj9bacUHQKUwscD6c1YtLSMR0..m7",contentSeeMore:"1_Y6RmMkb0YevJJ.TADaueTSHeKR.MbzMdJYB.z5c6n.87",usun_krok1:"nXc1v3tcuSKvkqqkAW_B3ZdS76eUd0_Lpoy6UCP3RLH.U7",usun_krok2:".XpKiGrAz6i6GsOd.oabb8dvHQJkkccDWbEPCNxJ8zP.X7",usun_captcha:".XBK6Gszzyi0UMNLBe0bOKe0P_2UAm_oWWjBqTyauIP.e7",wiecej_odpowiedzi:".ReVHWtvyeyJEgAjcb60veVzj36R7o9KAWlq2z15HDn.o7",recaptcha_view_pierwsza:"nSbg9Hsc4065oKvZSPmOn4ZQTBQpw5BrRL4WYAH8wr7..7",recaptcha_klik_checkbox:"pyNAt.LY888uCpvXnAx2cJRp.q6GG7rf6ehI4FBfP3f.G7",recaptcha_view_dodatkowa:".W1KWGthz2iJCXMsKe4j0rPoXfdW8nswU6_YdCVTl1j.U7",recaptcha_rozwiazanie_dodatkowa:"p3zqlfOmv7CE8IMu1LmzqIaw.q4pg7rfDtXOnIedZ0f.k7"},app:{AddComment:".XpK6GrAzyhUumgwPRo1itUKHQHBTscDBIpYtKVVn4j.U7",voteup:"nXBA5Hug8w_EaYDpldx5RcdRfQtktYc0KP2oiLQgTyP.t7",votedown:"nXBA5Hug8w_EaYDpldx5RcdRfQtktYc0KP2oiLQgTyP.t7",changePage:".R.qKGuzv6dUbjiodbv9rtTI38LBaq9nzo76sVI2NGP.j7",contentSeeMore:"nd.gxHsg4w5KUfEmrrQRHcdRPw1ktW_4v1KEd6dSZCD.k7",usun_krok1:"nd.qJnsgv3.klTioJap1vsdRfQtktYc0X68iS9c8zzj.K7",usun_krok2:"B3.gIuLJ41e.v5so2Lb1RsdRP_1ktW_oXzUqna7EJLv.57",usun_captcha:"nXngInst41bkZPF2JPkZRadyfSuUHodEiSIiqwvSd5..i7",wiecej_odpowiedzi:".X.gImsz41e6sVEh.qM58tUoHQHBKscDbmXSdwJvx6z.97",recaptcha_view_pierwsza:"ByNAsuNa85i0PjyMxHtWUrPo7FRW8tAGKbpMaPfCkkf.i7",recaptcha_klik_checkbox:"px1KtfM2z7GEUBNxnGYD.IXyTF4pZ5A3RDacPVorwnz.F7",recaptcha_view_dodatkowa:"nSzgknu_45cPDwxWyTOWNpRp7FSGG9AGs7BMadTQanv.B7",recaptcha_rozwiazanie_dodatkowa:"ByLqluNav7BUn_L6.A3L0LPoTF5W8pA3U8Wcv6U3wtD.J7"}},O={_requestAnimFrame:function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),_move:function(a){document.documentElement.scrollTop=a,document.body.parentNode.scrollTop=a,document.body.scrollTop=a},_easeInOutQuad:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:(a--,-c/2*(a*(a-2)-1)+b)},_inOutQuintic:function(a,b,c,d){var e,f;return e=(a/=d)*a,f=e*a,b+c*(6*f*e+-15*e*e+10*f)},scrollToPosition:function(a,b,c){var d=this,e=this._requestAnimFrame,f=this.getScrollPosition(),g=a-f,h=0,i=20,j=void 0===c?500:c,k=function(){h+=i,d._move(d._easeInOutQuad(h,f,g,j)),h<j?e(k):b&&"function"==typeof b&&b()};k()},getScrollPosition:function(){return(window.pageYOffset||document.scrollTop||0)-(document.clientTop||0)}},P={_tooltip:null,_hideTimeout:null,getTooltip:function(){return null===this._tooltip&&(this._tooltip=l("div"),m(document.body,this._tooltip)),this._tooltip.className="forum__tooltip",this._tooltip},show:function(a,b,c,d,e){var f,g=this,i=a.getBoundingClientRect(),k=i.top+O.getScrollPosition(),l=this.getTooltip(),m=function(){g._hideTimeout&&clearTimeout(g._hideTimeout),g._hideTimeout=setTimeout(function(){j(l,"forum__tooltip--visible"),o(a,d,m)},200)};switch(l.innerHTML=e,h(l,"forum__tooltip--"+b),f=l.getBoundingClientRect(),l.style.left=i.left+i.width/2-f.width/2+"px",b){case"bottom":l.style.top=k+i.height+10+"px";break;case"top":default:l.style.top=k-f.height-10+"px"}h(l,"forum__tooltip--visible"),!1!==c&&(this._hideTimeout&&clearTimeout(this._hideTimeout),this._hideTimeout=setTimeout(function(){j(l,"forum__tooltip--visible"),!1!==d&&o(a,d,m)},c)),!1!==d&&n(a,d,m)}},Q=function(){var a={urlParams:{},parseUrl:function(a){var b,c,d;if(!0!==a)return this.urlParams;for(b="#"===window.location.hash.slice(0,1)?window.location.hash.slice(1).split("&"):"",d=0;d<b.length;d+=1)c=b[d].split("="),c[0].length>0&&(this.urlParams[c[0]]=c[1]||null);return this.urlParams},getParam:function(a){return this.urlParams[a]||null},setParam:function(a,b){this.urlParams[a]=b},makeUrl:function(a){return window.location.href.split("#")[0]+"#"+this._getParamUrl(a)},saveUrl:function(){try{history.replaceState("","",this.makeUrl(this.urlParams))}catch(a){window.location.hash=this._getParamUrl(this.urlParams)}},_getParamUrl:function(a){var b=[];return Object.keys(a).forEach(function(c){b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]))}),b.join("&")}};return a.parseUrl(!0),a}();if(window.Inpl=window.Inpl||{},window.Inpl.hasOwnProperty("ForumManager"))throw new Error("Istnieje już window.Inpl.ForumManager!");var R={url:{premiumInfo:"http://forum.interia.pl/wyroznianie-komentarzy-pod-artykulem-tematy,dId,2977106",premiumLaw:"http://firma.interia.pl/promowaniekomentarzy",rules:"http://firma.interia.pl/regulamin#comnt",contact:"http://firma.interia.pl/kontakt?serwname=forum"},user:{nickMaxLength:16,contentMaxLength:4e3},api:{attachmentLimitNumber:3,attachmentRetryNumber:5}};window.Inpl.ForumManager=u({},new x(["create","remove"]),{_instanceList:{},createInstance:function(a){var b;return this._checkOptions(a)?null!==this.getInstance(a.placeName)?null:(b=new I(a),this._instanceList[a.placeName]=b,this.fire("create",b),b):null},recreateInstance:function(a){var b,c,d=a;return d.hasOwnProperty("placeName")?(b=this.getInstance(d.placeName),null!==b&&(c=b.getOptions(),d=u(c,d),this.removeInstance(d.placeName)),this.createInstance(d)):null},getInstance:function(a){return this._instanceList.hasOwnProperty(a)?this._instanceList[a]:null},removeInstance:function(a){var b=this.getInstance(a);null!==b&&(b.remove(),delete this._instanceList[a],this.fire("remove",b))},_checkOptions:function(a){return!!a&&(!!a.hasOwnProperty("placeName")&&!!a.hasOwnProperty("containerDom"))}});var S=function(){function a(a){return"function"==typeof a}function b(a){return"object"==typeof a}function c(a){"undefined"!=typeof setImmediate?setImmediate(a):"undefined"!=typeof process&&process.nextTick?process.nextTick(a):setTimeout(a,0)}var d;return function e(f){var g,h=[],i=[],j=function(a,b){return null==g&&null!=a&&(g=a,h=b,i.length&&c(function(){for(var a=0;a<i.length;a++)i[a]()})),g};return j.then=function(j,k){var l=e(f),m=function(){function c(e){var f,g=0;try{if(e&&(b(e)||a(e))&&a(f=e.then)){if(e===l)throw new TypeError;f.call(e,function(){g++||c.apply(d,arguments)},function(a){g++||l(!1,[a])})}else l(!0,arguments)}catch(h){g++||l(!1,[h])}}try{var e=g?j:k;a(e)?c(e.apply(d,h||[])):l(g,h)}catch(f){l(!1,[f])}};return null!=g?c(m):i.push(m),l},f&&(j=f(j)),j}}(),T=function(a){var b=function(a){var b=[],c=/\[\]$/,d=function(a){return"[object Array]"===Object.prototype.toString.call(a)},e=function(a,c){c="function"==typeof c?c():null===c?"":void 0===c?"":c,b[b.length]=encodeURIComponent(a)+"="+encodeURIComponent(c)},f=function(a,g){var h,i,j;if(a)if(d(g))for(h=0,i=g.length;h<i;h++)c.test(a)?e(a,g[h]):f(a+"["+("object"==typeof g[h]?h:"")+"]",g[h]);else if(g&&"[object Object]"===String(g))for(j in g)f(a+"["+j+"]",g[j]);else e(a,g);else if(d(g))for(h=0,i=g.length;h<i;h++)e(g[h].name,g[h].value);else for(j in g)f(j,g[j]);return b};return f("",a).join("&").replace(/%20/g,"+")},c={},d="json",e="post",f=null,g=0,h=[],i=a.XMLHttpRequest?function(){return new a.XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")},j=""===i().responseType,k=function(k,l,m,n,o){k=k.toUpperCase(),m=m||null,n=n||{};for(var p in c)if(!(p in n))if("object"==typeof c[p]&&"object"==typeof n[p])for(var q in c[p])n[p][q]=c[p][q];else n[p]=c[p];var r,s,t,u,v,w=!1,x=!1,y=!1,z=0,A={},B={text:"*/*",xml:"text/xml",json:"application/json",post:"application/x-www-form-urlencoded",document:"text/html"},C={text:"*/*",xml:"application/xml; q=1.0, text/xml; q=0.8, */*; q=0.1",json:"application/json; q=1.0, text/*; q=0.8, */*; q=0.1"},D=!1,E=S(function(b){return b.abort=function(){y||(s&&4!=s.readyState&&s.abort(),D&&(--g,D=!1),y=!0)},b.send=function(){if(!D){if(g==f)return void h.push(b);if(y)return void(h.length&&h.shift().send());if(++g,D=!0,s=i(),r&&("withCredentials"in s||!a.XDomainRequest||(s=new XDomainRequest,x=!0,"GET"!=k&&"POST"!=k&&(k="POST"))),x?s.open(k,l):(s.open(k,l,n.async,n.user,n.password),j&&n.async&&(s.withCredentials=n.withCredentials)),!x)for(var c in A)A[c]&&s.setRequestHeader(c,A[c]);if(j&&"auto"!=n.responseType)try{s.responseType=n.responseType,w=s.responseType==n.responseType}catch(d){}j||x?(s.onload=F,s.onerror=G,x&&(s.onprogress=function(){})):s.onreadystatechange=function(){4==s.readyState&&F()},n.async?"timeout"in s?(s.timeout=n.timeout,s.ontimeout=H):t=setTimeout(H,n.timeout):x&&(s.ontimeout=function(){}),"auto"!=n.responseType&&"overrideMimeType"in s&&s.overrideMimeType(B[n.responseType]),o&&o(s),x?setTimeout(function(){s.send("GET"!=k?m:null)},0):s.send("GET"!=k?m:null)}},b}),F=function(){var b;if(D=!1,clearTimeout(t),h.length&&h.shift().send(),!y){--g;try{if(w){if("response"in s&&null===s.response)throw"The request response is empty";v=s.response}else{if("auto"==(b=n.responseType))if(x)b=d;else{var c=s.getResponseHeader("Content-Type")||"";b=c.indexOf(B.json)>-1?"json":c.indexOf(B.xml)>-1?"xml":"text"}switch(b){case"json":if(s.responseText.length)try{v="JSON"in a?JSON.parse(s.responseText):new Function("return ("+s.responseText+")")()}catch(e){throw"Error while parsing JSON body : "+e}break;case"xml":try{a.DOMParser?v=(new DOMParser).parseFromString(s.responseText,"text/xml"):(v=new ActiveXObject("Microsoft.XMLDOM"),v.async="false",v.loadXML(s.responseText))}catch(e){v=void 0}if(!v||!v.documentElement||v.getElementsByTagName("parsererror").length)throw"Invalid XML";break;default:v=s.responseText}}if("status"in s&&!/^2|1223/.test(s.status))throw s.status+" ("+s.statusText+")";E(!0,[s,v])}catch(e){E(!1,[e,s,v])}}},G=function(a){y||(a="string"==typeof a?a:"Connection aborted",E.abort(),E(!1,[new Error(a),s,null]))},H=function(){y||(n.attempts&&++z==n.attempts?G("Timeout ("+l+")"):(s.abort(),D=!1,E.send()))};if(n.async=!("async"in n)||!!n.async,n.cache="cache"in n&&!!n.cache,n.dataType="dataType"in n?n.dataType.toLowerCase():e,n.responseType="responseType"in n?n.responseType.toLowerCase():"auto",n.user=n.user||"",n.password=n.password||"",n.withCredentials=!!n.withCredentials,n.timeout="timeout"in n?parseInt(n.timeout,10):3e4,n.attempts="attempts"in n?parseInt(n.attempts,10):1,u=l.match(/\/\/(.+?)\//),r=u&&!!u[1]&&u[1]!=location.host,"ArrayBuffer"in a&&m instanceof ArrayBuffer?n.dataType="arraybuffer":"Blob"in a&&m instanceof Blob?n.dataType="blob":"Document"in a&&m instanceof Document?n.dataType="document":"FormData"in a&&m instanceof FormData&&(n.dataType="formdata"),null!==m)switch(n.dataType){case"json":m=JSON.stringify(m);break;case"post":m=b(m)}if(n.headers){var I=function(a,b,c){return b+c.toUpperCase()};for(u in n.headers)A[u.replace(/(^|-)([^-])/g,I)]=n.headers[u]}return"Content-Type"in A||"GET"==k||n.dataType in B&&B[n.dataType]&&(A["Content-Type"]=B[n.dataType]),A.Accept||(A.Accept=n.responseType in C?C[n.responseType]:"*/*"),r||"X-Requested-With"in A||(A["X-Requested-With"]="XMLHttpRequest"),n.cache||"Cache-Control"in A||(A["Cache-Control"]="no-cache"),"GET"==k&&m&&"string"==typeof m&&(l+=(/\?/.test(l)?"&":"?")+m),n.async&&E.send(),E},l=function(a){var b=[],c=0,d=[];return S(function(e){var f=-1,g=function(a){return function(g,h,i,j){var l=++f;return++c,b.push(k(a,e.base+g,h,i,j).then(function(a,b){d[l]=arguments,--c||e(!0,1==d.length?d[0]:[d])},function(){e(!1,arguments)})),e}};e.get=g("GET"),e.post=g("POST"),e.put=g("PUT"),e.delete=g("DELETE"),e.catch=function(a){return e.then(null,a)},e.complete=function(a){var b=function(){a()};return e.then(b,b)},e.map=function(a,b,c,d,e){return g(a.toUpperCase()).call(this,b,c,d,e)};for(var h in a)h in e||(e[h]=a[h]);return e.send=function(){for(var a=0,c=b.length;a<c;++a)b[a].send();return e},e.abort=function(){for(var a=0,c=b.length;a<c;++a)b[a].abort();return e},e})},m={base:"",get:function(){return l(m).get.apply(this,arguments)},post:function(){return l(m).post.apply(this,arguments)},put:function(){return l(m).put.apply(this,arguments)},delete:function(){return l(m).delete.apply(this,arguments)},map:function(){return l(m).map.apply(this,arguments)},xhr2:j,limit:function(a){return f=a,m},setDefaultOptions:function(a){return c=a,m},setDefaultXdrResponseType:function(a){return d=a.toLowerCase(),m},setDefaultDataType:function(a){return e=a.toLowerCase(),m},getOpenRequests:function(){return g}};return m}(window);y.prototype=u(y.prototype,{getAttachment:function(){return this._attachment},remove:function(){o(window,"resize",this._viewportResizeListener)},_viewportResizeListener:function(){this._viewportResize(this.dom.content)},render:function(){var a=this,b=this.getAttachment(),c=m(this.dom.content=l("div","forum__layer-content"),m(l("div","forum__layer-iframe"),this.dom.iframe=l("iframe","forum__layer-iframe-iframe",null,{src:b.getIframeUrl(),frameborder:0,allowfullscreen:!0}),this.dom.ratio=l("div","forum__layer-iframe-ratio")));return setTimeout(function(){a._viewportResizeListener=a._viewportResizeListener.bind(a),a._viewportResizeListener(),n(window,"resize",a._viewportResizeListener)},0),c},_viewportResize:function(a){var b=window.innerHeight-2*this.settings.layerMargin,c=window.innerWidth-2*this.settings.layerMargin;c=c>1200?1200:c;var d=.5622;this.dom.ratio.style.paddingBottom=100*d+"%",d>b/c?(a.style.width=b/d+"px",a.style.height=b+"px"):(a.style.width=c+"px",a.style.height=c*d+"px")}}),z.prototype=u(z.prototype,{getAttachment:function(){return this._attachment},remove:function(){o(window,"resize",this.viewportResizeListener)},viewportResizeListener:function(){this.viewportResize(this.dom.content,this.dom.imageNode)},imageLoaded:function(a,b){p(a,m(this.dom.content=l("div","forum__layer-content"),m(l("div","forum__layer-image"),this.dom.imageNode=l("img","",null,{src:b.getUrl()})))),this.viewportResizeListener=this.viewportResizeListener.bind(this),this.dom.imageNode.onload=this.viewportResizeListener,this.viewportResizeListener(),n(window,"resize",this.viewportResizeListener)},render:function(){var a=this,b=this.getAttachment(),c=m(l("div","forum__layer-content"),l("div","forum__layer-image forum__layer-image--loading")),d=new Image;return d.onload=function(){a.imageLoaded(c,b)},d.src=b.getUrl(),c},viewportResize:function(a,b){var c=b.naturalWidth,d=b.naturalHeight,e=window.innerWidth-2*this.settings.layerMargin,f=window.innerHeight-2*this.settings.layerMargin;c/d>e/f?(b.style.width=e>c?c+"px":e+"px",b.style.height="auto"):(b.style.height=f>d?d+"px":f+"px",b.style.width="auto"),a.style.width=b.clientWidth+"px",a.style.height=b.clientHeight+"px"}}),A.prototype=u(A.prototype,{getForum:function(){return this._forum},getAttachment:function(){return this._attachment},show:function(){m(document.body,this._render())},hide:function(){this.dom.instance.parentNode&&this.dom.instance.parentNode.removeChild(this.dom.instance),this._removeElementInstance()},_hideListener:function(a){var b=this;a&&(a.target===b.dom.instance||a.target===b.dom.closeButton||a.which&&27==a.which)&&(b.hide(),o(window,"keydown",b._hideListener))},_removeElementInstance:function(){null!==this._elementInstance&&"function"==typeof this._elementInstance.remove&&this._elementInstance.remove()},_createElementInstance:function(a){var b,c=null;switch(a){case"image":c=new z(this.getAttachment());break;case"video":b=this.getAttachment(),null===b.getIframeUrl()?window.open(b.getUrl(),"_blank"):c=new y(this.getAttachment());break;case"link":window.open(this.getAttachment().getUrl(),"_blank")}return this._elementInstance=c,
this._elementInstance},_elementInstanceRender:function(a){return"function"==typeof a.render?a.render():null},_renderByType:function(a){var b=this._createElementInstance(a);return null===b?null:this._elementInstanceRender(b)},_render:function(){var a=this,b=this._renderByType(this.getAttachment().getType());return null===b?null:(this.dom.instance=m(l("div","forum__layer"),this.dom.closeButton=l("div","forum__layer-close",null,{title:"Zamknąć możesz też klawiszem ESC."}),b),this._hideListener=this._hideListener.bind(this),n(window,"keydown",this._hideListener),n(this.dom.closeButton,"click",this._hideListener),n(this.dom.instance,"click",this._hideListener),setTimeout(function(){h(a.dom.instance,"forum__layer--anim-visible")},0),this.dom.instance)}}),B.prototype=u(B.prototype,{getId:function(){return this._id},getForum:function(){return this._forum},getComment:function(){return this._comment},getNick:function(){return this._nick},getAvatarId:function(){return this._avatarId},getAvatarExtension:function(){return this._avatarExtension},getAvatarUrl:function(){return this.getAvatarId()&&this.getAvatarExtension()?this.getForum().getAttachmentImage().makeUrl(this.getAvatarId(),this.getAvatarExtension(),{small:"C414"}):""},getProfileUrl:function(){return this._profileUrl},isLogged:function(){return null!==this._id},renderNick:function(){var a,b=this;return this.isLogged()?(a=l("a","forum__comment-author-name",this.getNick(),null!==this.getProfileUrl()?{href:this.getProfileUrl(),target:"_blank"}:{}),n(a,"click",function(){iwa("trackEvent","Komentarze","-","klik",b.getForum().getDsgUserType(),"nick")})):a=l("span","forum__comment-author-name","~"+this.getNick()),a},renderParentCommentAuthor:function(){var a,b,c=this.getComment(),d=c.getParentCommentId(),e=null,f=c.getMainLevelComment();return null!==c.getParentAuthor()&&f instanceof C&&(e=m(l("span","forum__comment-author-parent","do "),l("span","forum__comment-author-parent-name",c.getParentAuthor()),l("span","forum__comment-author-parent-link","&nbsp;")),b=f.getReplyCommentList(),a=b.filter(function(a){return a.getId()===d}),a.length&&n(e,"click",function(){c.getForum().scrollToElement(a[0].getInstanceDom())})),e},render:function(){return m(l("div","forum__comment-author"),this.renderNick(),this.renderParentCommentAuthor(),l("span","forum__comment-author-date","- "+this.getComment().getDateText()))},renderAvatar:function(){var a,b=this;return this.isLogged()&&this.getAvatarUrl()?(a=m(l("a","forum__comment-avatar forum__comment-avatar--logged",null,null!==this.getProfileUrl()?{href:this.getProfileUrl(),target:"_blank"}:{}),l("img","forum__comment-avatar-img",null,{src:this.getAvatarUrl()})),n(a,"click",function(){iwa("trackEvent","Komentarze","-","klik",b.getForum().getDsgUserType(),"avatar")})):a=l("div","forum__comment-avatar forum__comment-avatar--guest"),a}}),C.prototype=u(C.prototype,{getId:function(){return this._id},getDatetime:function(){return this._datetime},getDateText:function(){return this._dateText},getContent:function(){return this._content},isPremium:function(){return this._premiumCount>0},getPremiumCount:function(){return this._premiumCount},getVoteup:function(){return this._voteup},getVotedown:function(){return this._votedown},getVoteStatus:function(){return this._voteStatus},getUrl:function(){return this.getForum().getUrl(this.getId())},hasReplies:function(){return this._replyCount>0},isMainLevel:function(){return null===this._parentCommentId},getReplyCount:function(){return this._replyCount},getParentAuthor:function(){return this._parentAuthor},getParentCommentId:function(){return this._parentCommentId},getAttachmentListData:function(){return this._attachmentListData||[]},getAttachmentList:function(){return this._attachmentList||[]},getActualPageNumber:function(){return this._actualPageNumber},setActualPageNumber:function(a){this._actualPageNumber=a},getPageCount:function(){return this._pageCount},setPageCount:function(a){this._pageCount=a},hasMoreReplies:function(){return this.getActualPageNumber()<this.getPageCount()-1},getInstanceDom:function(){return this.dom.instance},getBlockDom:function(){return this.dom.block},getForum:function(){return this._forum},getUser:function(){return this._user},getMainLevelComment:function(){return this._mainLevelComment},getAuthor:function(){return this._author instanceof B||(this._author=new B(this.getForum(),this,this._authorData)),this._author},getFormAdd:function(){return this._formAdd instanceof F||(this._formAdd=new F(this._forum,this.getUser(),this)),this._formAdd},removeFormAdd:function(){delete this._formAdd,this._formAdd=null,this.dom.formAdd=p(this.dom.formAdd,l("div"))},getFormAbuse:function(){return this._formAbuse instanceof E||(this._formAbuse=new E(this._forum,this.getUser(),this)),this._formAbuse},getFormPremium:function(){return this._formPremium instanceof H||(this._formPremium=new H(this._forum,this)),this._formPremium},getReplyCommentList:function(){return this._commentList},getReplyCommentById:function(a){var b;return b=this.getReplyCommentList().filter(function(b){return b.getId()===a}),1===b.length?b[0]:null},loadReplyListPending:function(){return null!==this._loadReplyPromise},showPreloader:function(){h(this.dom.repliesShowButton,"forum__comment-replies-show--preloader"),null!==this.dom.commentReplyMoreButton&&h(this.dom.commentReplyMoreButton,"forum__comment-more-button--preloader")},hidePreloader:function(){j(this.dom.repliesShowButton,"forum__comment-replies-show--preloader"),null!==this.dom.commentReplyMoreButton&&j(this.dom.commentReplyMoreButton,"forum__comment-more-button--preloader")},_wasReplyListLoaded:!1,_isReplyListVisible:!1,loadReplyList:function(a,b){var c=this,d=this.getForum();return this.showPreloader(),this._wasReplyListLoaded=!0,this._loadReplyPromise=this.getForum().getApi().getCommentReplyList(a,d.getFilterValue(),d.getSortValue(),this.getId(),b).then(function(a,b){c.hidePreloader(),c.renderReplyList(c.parseCommentReplyListData(b)),c._loadReplyPromise=null}).catch(function(a){c.hidePreloader(),c._loadReplyPromise=null}),this._loadReplyPromise},showReplyList:function(a){return this._isReplyListVisible=!0,h(this.dom.repliesShowButton,"forum__comment-replies-show--open"),h(this.dom.replyList,"forum__comment-replies--open"),iwa("trackEvent","Komentarze","-","klik",this.getForum().getDsgUserType(),"wiecej_odpowiedzi"),t(this.getForum().isMobileApp(),"wiecej_odpowiedzi"),!1===this._wasReplyListLoaded?this.loadReplyList(this.getActualPageNumber(),a):S(function(a){return a.catch=function(b){return a.then(null,b)},a})},hideReplyList:function(){this._isReplyListVisible=!1,j(this.dom.repliesShowButton,"forum__comment-replies-show--open"),j(this.dom.replyList,"forum__comment-replies--open")},parseCommentReplyListData:function(a){var b;return a&&a.result&&a.result.commentList?(b=a.result,this.setActualPageNumber(b.commentListPageNumber),this.setPageCount(b.commentListPageCount),this._commentList=b.commentList=this.getForum()._instanceComment(b.commentList,this),b):null},sendDelete:function(){var a=this,b=this.getForum().getApi();b.getCsrfToken(this.getId()).then(function(c,d){var e=d.result.csrf||null;return b.deleteComment(e,a.getId()).then(function(b,c){c&&0===c.errorCode&&c.result&&!0===c.result.deleted?a.renderDeleteInfo():a.unmarkAsBeforeDelete()})}).catch(function(b){a.unmarkAsBeforeDelete()})},saveVoteStatus:function(a,b,c){this.getForum().getStorage().saveCommentVote(this.getId(),a,b,c)},sendVote:function(a,b){var c,d=this,e="forum__comment-action--loading",f=this.getForum().getApi();if(null!==d._voteStatus)return void P.show(b,"top",3e3,"mouseout","Głosowałeś już na ten komentarz");d._voteStatus=a,h(b,e),f.getCsrfToken(this.getId()).then(function(g,i){var k=i.result.csrf||null,l=d.getVotedown(),m=d.getVoteup();switch(a){case"down":l+=1,c=f.votedown(k,d.getId());break;case"up":m+=1,c=f.voteup(k,d.getId())}return c.then(function(c,f){if(0!==f.errorCode)throw new Error("Błąd API: "+f.errorMessage);d.saveVoteStatus(a,l,m),j(b,e),h(b,"up"===a?"forum__comment-action--voteup-marked":"forum__comment-action--votedown-marked"),d.renderUpdateVote(m,l),t(d.getForum().isMobileApp(),"vote"+a)})}).catch(function(a){d._voteStatus=null,j(b,e)})},parseAttachmentListData:function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(new D(this,a[b]));return this._attachmentList=c,this._attachmentList},renderAttachmentList:function(){var a=this.parseAttachmentListData(this.getAttachmentListData());return 0===a.length?null:m(l("div","forum__comment-files"),function(){return a.map(function(a){return a.render()})}())},renderRepliesShowButton:function(){var a=this;return this.hasReplies()?(this.dom.repliesShowButton=l("a","forum__comment-replies-show","Odpowiedzi: "+this.getReplyCount(),{href:"#",title:"Lista odpowiedzi"}),n(this.dom.repliesShowButton,"click",function(b){b.preventDefault(),a._isReplyListVisible?a.hideReplyList():a.showReplyList()}),this.dom.repliesShowButton):null},renderBottom:function(){var a=this,b=this.getVoteStatus(),c=m(l("div","forum__comment-bottom"),m(l("div","forum__comment-actions"),function(){var b;return b=a.isMainLevel()?m(l("a","forum__comment-action forum__comment-action--promote"+(a.isPremium()?" forum__comment-action--premium":""),null,{href:"#"}),l("span","forum__comment-action--promote-text","Wyróżnij"),l("span","forum__comment-action--promote-count",a.isPremium()?a.getPremiumCount():"")):l("span"),a.dom.actionPromoteButton=b,a.dom.actionPromoteButton}(),this.dom.actionVoteupButton=l("a","forum__comment-action forum__comment-action--voteup"+("up"===b?" forum__comment-action--voteup-marked":""),this.getVoteup(),{href:"#"}),this.dom.actionVotedownButton=l("a","forum__comment-action forum__comment-action--votedown"+("down"===b?" forum__comment-action--votedown-marked":""),this.getVotedown(),{href:"#"}),this.dom.actionReplyButton=l("a","forum__comment-action forum__comment-action--reply","Odpowiedz",{href:"#"})),this.renderRepliesShowButton());return n(this.dom.actionReplyButton,"click",function(b){var c,d,e=O.getScrollPosition();b.preventDefault(),a.renderFormAdd(a.getFormAdd()),c=a.getFormAdd().getInstanceDom().getBoundingClientRect(),(d=c.bottom-window.innerHeight)>0&&O.scrollToPosition(d+e+10)}),n(this.dom.actionPromoteButton,"click",function(b){var c,d,e=O.getScrollPosition();iwa("trackEvent","Komentarze","-","klik",a.getForum().getDsgUserType(),"wyroznij"),b.preventDefault(),a.renderFormPremium(a.getFormPremium()),c=a.getFormPremium().getInstanceDom().getBoundingClientRect(),(d=c.bottom-window.innerHeight)>0&&O.scrollToPosition(d+e+10)}),n(this.dom.actionVoteupButton,"click",function(b){b.preventDefault(),a.sendVote("up",this)}),n(this.dom.actionVotedownButton,"click",function(b){b.preventDefault(),a.sendVote("down",this)}),c},renderUpdateVote:function(a,b){this.dom.actionVoteupButton.innerHTML=a||0,this.dom.actionVotedownButton.innerHTML=b||0},renderReplyMoreButton:function(){var a=this;return null===this.dom.commentReplyMoreButton&&(this.dom.commentReplyMoreButton=m(l("div","forum__comment-more-button"),l("div","forum__comment-more-button-text","Zobacz kolejne odpowiedzi")),n(this.dom.commentReplyMoreButton,"click",function(){a.loadReplyListPending()||a.loadReplyList(a.getActualPageNumber()+1)})),null===this.dom.commentReplyMoreButton||this.hasMoreReplies()||h(this.dom.commentReplyMoreButton,"forum__comment-more-button--hidden"),this.dom.commentReplyMoreButton},renderReplyList:function(a){return null===a?(null===this.dom.replyList&&(this.dom.replyList=l("div")),this.dom.replyList):(h(this.dom.replyList,"forum__comment-replies"),m(this.dom.replyList,function(){return a.commentList.map(function(a){return a.render()})}(),this.renderReplyMoreButton()),this.dom.replyList)},renderFormAdd:function(a){return a.isRendered()?a.toggleShow():(this.dom.formAdd=p(this.dom.formAdd,a.render()),h(this.dom.formAdd,"forum__add--reply")),this.dom.formAdd},renderFormAbuse:function(a){return a.isRendered()?a.toggleShow():this.dom.formAbuse=p(this.dom.formAbuse,a.render()),this.dom.formAbuse},renderFormPremium:function(a){return a.isRendered()?a.toggleShow():this.dom.formPremium=p(this.dom.formPremium,a.render()),this.dom.formPremium},renderOptionLinkblock:function(){var a=this,b=m(l("div","forum__comment-option-linkblock"),this.dom.optionLinkInput=l("input","forum__comment-option-linkblock-input",null,{type:"text",value:a.getUrl(),readonly:"readonly"}),this.dom.optionLinkClose=l("div","forum__comment-option-linkblock-close"));return n(this.dom.optionLinkClose,"click",function(b){h(a.dom.optionLinkblock,"forum__comment-option-linkblock--hidden"),b.preventDefault(),b.stopPropagation()}),b},renderOptions:function(){var a=this,b=m(l("div","forum__comment-option"),this.dom.optionLink=m(l("div","forum__comment-option-link"),this.dom.optionLinkblock=l("div")),this.dom.optionAbuse=l("div","forum__comment-option-abuse","",{title:"Zgłoś do usunięcia"})),c=null;return n(this.dom.optionLink,"click",function(){null===c?(c=p(a.dom.optionLinkblock,a.renderOptionLinkblock()),a.dom.optionLinkblock=c):j(c,"forum__comment-option-linkblock--hidden"),a.dom.optionLinkInput&&(a.dom.optionLinkInput.focus(),a.dom.optionLinkInput.select())}),n(this.dom.optionAbuse,"click",function(){iwa("trackEvent","Komentarze","-","klik",a.getForum().getDsgUserType(),"usun_krok1"),t(a.getForum().isMobileApp(),"usun_krok1");var b,c,d=O.getScrollPosition();a.renderFormAbuse(a.getFormAbuse()),b=a.getFormAbuse().getInstanceDom().getBoundingClientRect(),(c=b.bottom-window.innerHeight)>0&&O.scrollToPosition(c+d)}),this.renderDeleteButton(this.dom.optionAbuse,b),b},markAsBeforeDelete:function(){h(this.getBlockDom(),"forum__comment-block--before-delete")},unmarkAsBeforeDelete:function(){j(this.getBlockDom(),"forum__comment-block--before-delete")},renderDeleteInfo:function(){p(this.getBlockDom(),l("div","forum__comment-delete-info","Komentarz (id:"+this.getId()+") został usunięty"))},renderDeleteButton:function(a,b){var c,d=this,e=0;this.getUser().canDeletePosts()?(m(b,c=l("div","forum__comment-option-delete")),n(c,"click",function(){d.markAsBeforeDelete(),setTimeout(function(){confirm("Usunąć komentarz?")?d.sendDelete():d.unmarkAsBeforeDelete()},100)})):(n(a,"mousedown touchstart",function(){clearTimeout(e),e=setTimeout(function(){d.getUser().checkCanDeletePosts().then(function(){d.getForum().refreshComments()}).catch(function(a){})},2e3)}),n(a,"mouseup mouseleave touchend",function(){clearTimeout(e)}))},renderContent:function(a){var b,c,d,e,f,g,h=this,i=a.replace(/<[^>]+>/g,""),j=r()?150:500,o=!1,p='... <span class="forum__comment-content-seemore-link">Rozwiń</span>';return i.length<j+30?l("div","forum__comment-content",a):(e=a.substr(0,j),g=e.split("<a ").length!==e.split("</a>").length?Math.min(e.length,e.lastIndexOf("<a ")):Math.min(e.length,Math.max(e.lastIndexOf(" "),e.lastIndexOf("</a>")+4)),e=e.substr(0,g),f=a.substr(g),b=m(l("div","forum__comment-content",e),d=l("span","forum__comment-content-long",f),c=l("span","forum__comment-content-seemore",p)),n(c,"click",function(){!1===o&&t(h.getForum().isMobileApp(),"contentSeeMore"),c.innerHTML=o?p:'<span class="forum__comment-content-seemore-link">Zwiń</span>',k(c,"forum__comment-content-seemore--open"),k(d,"forum__comment-content-long--open"),o=!o}),b)},render:function(){var a=this,b="";return this.isPremium()?b="forum__comment-block--premium":this.getId()===this.getForum().getVisitingCommentId()&&(b="forum__comment-block--visiting"),this.dom.instance=m(l("div","forum__comment"),m(this.dom.block=l("div","forum__comment-block "+b),m(l("div","forum__comment-header"),this.getAuthor().renderAvatar(),this.getAuthor().render(),this.renderOptions()),a.renderContent(a.getContent()),this.renderAttachmentList(),this.renderBottom()),this.dom.formPremium=l("div"),this.dom.formAbuse=l("div"),this.dom.formAdd=l("div"),this.renderReplyList(null)),this.dom.instance}}),D.prototype=u(D.prototype,{getOriginalUrl:function(){return this._originalUrl},getComment:function(){return this._comment},getType:function(){return this._type},getThumbId:function(){return this._thumbId},getThumbExtension:function(){return this._thumbExtension},getExternalThumbUrl:function(){return this._externalThumbUrl},getThumbUrl:function(){return this.getThumbId()&&this.getThumbExtension()?this.getComment().getForum().getAttachmentImage().makeUrl(this.getThumbId(),this.getThumbExtension(),{small:"C416"}):null},getUrl:function(){return this._proxyUrl},getIframeUrl:function(){return this._iframeUrl},getLayer:function(){return this._layer instanceof A||(this._layer=new A(this.getComment().getForum(),this)),this._layer},showLayer:function(){this.getLayer().show()},render:function(){var a=this;return null==a.getThumbUrl()?a.dom.instance:(this.dom.instance=m(l("div","forum__comment-file"),m(l("div","forum__comment-file-thumb"),m(l("a","",null,{href:this.getUrl()}),l("span","forum__comment-file-thumb-ico forum__comment-file-thumb-ico--"+this.getType()),l("img","forum__comment-file-thumb-img",null,{src:this.getThumbUrl()})))),n(this.dom.instance,"click",function(b){(!b.which||b.which&&2!==b.which)&&(b.preventDefault(),a.showLayer())}),this.dom.instance)}}),E.prototype=u(E.prototype,{isRendered:function(){return null!==this.dom.instance},getInstanceDom:function(){return this.dom.instance},getForum:function(){return this._forum},getComment:function(){return this._comment},getUser:function(){return this._user},getCaptchaId:function(){return this._captchaUid},setCaptchaId:function(a){return this._captchaUid=a},getReasonId:function(){return 3},getCaptchaApi:function(){return this._captchaApi instanceof b||(this._captchaApi=new b({apiUrl:this.getForum().settings.captchaServiceUrl})),this._captchaApi},getDescription:function(){return this.dom.reasonTextarea&&this.dom.reasonTextarea.value?this.dom.reasonTextarea.value:null},getCaptchaValue:function(){return this.dom.captchaInput&&this.dom.captchaInput.value?this.dom.captchaInput.value:null},toggleShow:function(){this.isRendered()&&k(this.dom.instance,"forum__abuse--hidden")},checkForm:function(){var a=!0;return null!==this.getCaptchaId()&&null===this.getCaptchaValue()&&(this.renderErrorMessage("Przepisz kod z obrazka."),a=!1),(null===this.getDescription()||this.getDescription().length<4)&&(this.renderErrorMessage("Uzupełnij powód zgłoszenia (min. 4 znaki).",!0),a=!1),a},send:function(){var a=this,b=this.getForum().getApi();this.showPreloader(),b.getCsrfToken(this.getComment().getId()).then(function(c,d){return b.abuse(d.result.csrf,a.getComment().getId(),a.getCaptchaId(),a.getCaptchaValue(),a.getReasonId(),a.getDescription()).then(function(b,c){a.sendResult(c),a.hidePreloader()})}).catch(function(b){a.hidePreloader(),a.renderErrorMessage("Serwer nie odpowiada - spróbuj ponownie za chwilę.")})},sendResult:function(a){a&&0===a.errorCode?(iwa("trackEvent","Komentarze","-","klik",this.getForum().getDsgUserType(),"usun_krok2"),t(this.getForum().isMobileApp(),"usun_krok2"),this.renderCorrectMessage()):this.renderErrorMessage(a.errorMessage)},showPreloader:function(){h(this.dom.submit,"forum__abuse-captcha-send--loading")},hidePreloader:function(){j(this.dom.submit,"forum__abuse-captcha-send--loading")},renderCorrectMessage:function(){var a=l("div","forum__abuse-correct-message","Dziękujemy za zgłoszenie");this.dom.content=p(this.dom.content,a)},renderErrorMessage:function(a,b){var c;if(c=null===a?l("div"):l("div","forum__abuse-error-message",a),!0===b)return h(this.dom.errorMessage,"forum__abuse-error-message"),void(this.dom.errorMessage.innerHTML=this.dom.errorMessage.innerHTML+"<hr />"+a);this.dom.errorMessage=p(this.dom.errorMessage,c)},renderNewCaptcha:function(){var a,b,c,d=this,e=this.getForum();null===this.dom.captchaInput&&(a=m(l("div","forum__abuse-captcha"),this.dom.captchaInput=l("input","forum__abuse-captcha-input",null,{type:"text",name:"captchaValue"}),this.dom.captcha=l("span"),this.dom.captchaRefresh=l("div","forum__abuse-captcha-refresh")),this.dom.captchaModule=p(this.dom.captchaModule,a),n(this.dom.captchaRefresh,"click",function(){iwa("trackEvent","Komentarze","-","klik",d.getForum().getDsgUserType(),"usun_captcha"),t(e.isMobileApp(),"usun_captcha"),d.renderNewCaptcha()})),b=l("div","forum__abuse-captcha-container forum__abuse-captcha-container--loading"),c=l("span"),this.dom.captcha=p(this.dom.captcha,m(b,c)),this.getCaptchaApi().getCaptcha(function(a,e){if(j(b,"forum__abuse-captcha-container--loading"),e)return h(b,"forum__abuse-captcha-container--timeout"),b.innerHTML='"(°_°)"',void d.renderErrorMessage(e);a&&a.url&&(d.renderErrorMessage(null),d.setCaptchaId(a.uid),p(c,l("img","forum__abuse-captcha-img",null,{src:a.url})))},3e4)},render:function(){var a=this;return this.dom.instance=m(l("div","forum__abuse"),this.dom.content=m(l("div"),l("div","forum__abuse-header","Zgłoś do usunięcia"),m(l("div","forum__abuse-form"),this.dom.reasonTextarea=l("textarea","forum__abuse-reason-input",null,{placeholder:"Podaj powód, dla którego zgłaszasz wpis do usunięcia"}),this.dom.errorMessage=l("div"),m(l("div","forum__abuse-bottom"),this.dom.captchaModule=l("div"),m(l("div","forum__abuse-captcha-actions"),m(l("div","forum__abuse-captcha-action"),this.dom.submit=l("div","forum__abuse-captcha-send","Wyślij")),m(l("div","forum__abuse-captcha-action"),this.dom.closeButton=l("div","forum__abuse-captcha-cancel","Anuluj"))))))),this.getUser().isLogged()||this.renderNewCaptcha(),n(this.dom.submit,"click",function(){a.checkForm()&&a.send()}),n(this.dom.closeButton,"click",function(){a.toggleShow()}),this.dom.instance}}),F.prototype=u(F.prototype,{isRendered:function(){return null!==this.dom.instance},getInstanceDom:function(){return this.dom.instance},getAttachmentMessageText:function(){return this._attachmentMessageText},getAttachmentMessageType:function(){return this._attachmentMessageType},showAttachmentMessage:function(a,b){this._attachmentMessageType=a,this._attachmentMessageText=b,this.dom.attachmentMessage=p(this.dom.attachmentMessage,this.renderAttachmentMessage())},renderAttachmentMessage:function(){return m(l("div","forum__add-bottom-message  forum__add-bottom-message--"+this.getAttachmentMessageType()),l("div","forum__add-bottom-message-inside",this.getAttachmentMessageText()))},getForum:function(){return this._forum},getUser:function(){return this._user},getComment:function(){return this._comment},getContent:function(){return this.dom.contentInput.value},remove:function(){var a=this.getComment();null!==a?a.removeFormAdd():this.getForum().reloadFormAdd()},renderUserAvatar:function(){var a=this.getUser();return a.isLogged()?m(l("div","forum__add-user-avatar forum__add-user-avatar--logged"),l("img","forum__add-user-avatar-img",null,{src:a.getAvatarUrl()})):l("div","forum__add-user-avatar forum__add-user-avatar--guest")},renderUserNick:function(){var a=this.getUser(),b=l("div","forum__add-user-author");return a.isLogged()?m(b,m(l("div","forum__add-user-author-text","Piszesz jako "),l("a","forum__add-user-author-name",a.getNick(),{href:this.getForum().getProfileSettingsUrl(),title:"Ustawienia Twoich danych profilowych"}))):m(b,this.dom.inputNick=l("input","forum__add-user-author-input",null,{type:"text",placeholder:"PODPISZ SIĘ",maxlength:R.user.nickMaxLength}))},renderUser:function(){return m(l("div","forum__add-user"),this.renderUserAvatar(),this.renderUserNick())},renderLinks:function(){var a=this;return m(l("div","forum__add-urls"),function(){return a.getForum().allowLoginUser()?m(l("div","forum__add-urls-login"),function(){if(a.getUser().isLogged())return l("a","forum__add-urls-login-link","Wyloguj się",{href:a.getForum().getLogoutUrl(),title:"Wyloguj się"});if(a.getUser().isLoggedMail()){var b=l("a","forum__add-urls-login-link","Ustaw nick",{href:a.getForum().getProfileActivateUrl(),title:"Ustaw swój nick, którym będziesz się podpisywać, dodając komentarze"});return n(b,"click",function(){iwa("trackEvent","Komentarze","-","klik",a.getForum().getDsgUserType(),"ustaw_nick")}),b}return l("a","forum__add-urls-login-link","Zaloguj się",{href:a.getForum().getLoginUrl(),title:"Zaloguj się, aby dodawać wpisy, używając nicku. Możesz też komentować anonimowo"})}()):null}(),m(l("div","forum__add-urls-rule"),l("a","forum__add-urls-rule-link","Regulamin",{href:R.url.rules,title:"Regulamin"})))},getParsedLinkList:function(){return this._linkList},_checkAttachmentListResponse:function(a){var b,c=this,d=!1,e=[];return a&&a.result&&a.result.list?(a.result.list.forEach(function(a){if(4===a.errorCode&&(d=!0),2===a.errorCode)return c.showAttachmentMessage("warning","Link <b>"+a.originalUrl+'</b> jest niedozwolony, więc został usunięty z treści Twojego komentarza! Sprawdź, które <a class="forum__add-bottom-message-link" href="http://forum.interia.pl/sprawdz-ktore-linki-mozesz-dodac-w-komentarzu-tematy,dId,2814582">linki</a> możesz dodać w komentarzu.'),void((b=c.findAttachmentByOriginalUrl(a.originalUrl))instanceof G&&b.remove());e.push(a)}),d&&c._tryNumber<=R.api.attachmentRetryNumber?(this.removeTryTimer(),this._tryTimer=function(a){return setTimeout(function(){c.sendAttachmentList(c.getParsedLinkList())},1e3*a*a)}(c._tryNumber),c._tryNumber+=1):this._checkAttachmentsHaveThumbs(),e):a},_checkAttachmentsHaveThumbs:function(){this._attachmentList.forEach(function(a){a.checkHasThumb()}),this.renderAttachmentList()},removeTryTimer:function(){null!==this._tryTimer&&clearTimeout(this._tryTimer)},removeAttachmentAdd:function(a){this._attachmentList=this._attachmentList.filter(function(b){return b!==a}),this._linkList=this._linkList.filter(function(b){return b!==a.getOriginalUrl()}),this.removeTextFromInput(a.getOriginalUrl()),this.renderAttachmentList()},removeTextFromInput:function(a){this.dom.contentInput.value=this.dom.contentInput.value.replace(a,"")},renderAttachmentList:function(){var a=this;if(null===this._attachmentList||0===this._attachmentList.length)return null===this.dom.attachmentList?this.dom.attachmentList=l("div"):this.dom.attachmentList=p(this.dom.attachmentList,l("div"));var b=m(l("div","forum__add-files"),function(){return a._attachmentList.map(function(a){return a.render()})}());return this.dom.attachmentList=p(this.dom.attachmentList,b)},toggleShow:function(){this.isRendered()&&k(this.dom.instance,"forum__add--hidden")},showPreloader:function(){h(this.dom.submit,"forum__add-bottom-submit--loading")},hidePreloader:function(){j(this.dom.submit,"forum__add-bottom-submit--loading")},checkForm:function(){var a=!0;if(!this.getUser().isLogged()&&""===this.dom.inputNick.value)return this.renderErrorMessage("Podpis jest wymagany."),a=!1;if(""===this.getContent())return this.renderErrorMessage("Uzupełnij treść komentarza."),a=!1;var b=this._forum.getReCaptchaApi();if(b.isRequired()){if(!b.isRender())return b.reset(),a=!1;if(!b.isValid())return b.reset(),this.renderErrorMessage(b.getErrorText()),a=!1;this.renderErrorMessage(null)}return a},getParentCommentId:function(){var a=this.getComment();return null!==a?a.getId():null},send:function(){var a=this,b=this.getForum().getApi(),c=null,d=this.getComment();this.showPreloader(),this.removeTryTimer(),null!==d&&(c=d.getId()),b.getCsrfToken(c).then(function(c,d){return b.addComment(d.result.csrf,a.getUser(),a.getParentCommentId(),a.getContent(),a.getParsedLinkList(),a._forum.getReCaptchaApi().getToken()).then(function(b,c){a.sendResult(c),a.hidePreloader()})}).catch(function(b){a.hidePreloader(),a.renderErrorMessage("Serwer nie odpowiada - spróbuj ponownie za chwilę.")})},sendResult:function(a){var b,c=this._forum.getReCaptchaApi();a&&0===a.errorCode?(iwa("trackEvent","Komentarze","-","klik",this.getForum().getDsgUserType(),"AddComment"),t(this.getForum().isMobileApp(),"AddComment"),this.renderCorrectMessage(a.result.commentId),c.isRequired()&&c.success()):(this.renderErrorMessage(a.errorMessage),c.isRequired()&&c.reset()),b=this.getInstanceDom().getBoundingClientRect(),b.top<0&&O.scrollToPosition(b.top+O.getScrollPosition()-10)},renderCorrectMessage:function(a){function b(a){if(a<1)return e.innerHTML="Kliknij i zobacz swój komentarz",j(e,"forum__addinfo-comment-button--disabled"),h(e,"forum__addinfo-comment-button--active"),q=!1,void(d.innerHTML="Twój komentarz został opublikowany!");e.innerHTML="Komentarz widoczny za "+a+" sek.",setTimeout(function(){b(a-1)},1e3)}var c,d,e,f,g,i,o=this,q=!0,r="forum__addinfo-comment-button--loading",s=m(l("div","forum__addinfo"),c=l("div","forum__addinfo-remove"),l("div","forum__addinfo-header","Dziękujemy za komentarz!"),d=l("div","forum__addinfo-text","Twój komentarz oczekuje na publikację."),e=l("div","forum__addinfo-comment-button forum__addinfo-comment-button--disabled"),m(l("div","forum__addinfo-block  forum__addinfo-block--premium",'<p class="forum__addinfo-block-p">Po opublikowaniu możesz wyróżnić ten komentarz, niech zobaczą go wszyscy!</p>'),l("a","forum__addinfo-more","Dowiedz się więcej &raquo;",{href:R.url.premiumInfo,target:"_blank"})),m(m(l("div","forum__addinfo-block  forum__addinfo-block--notice"),f=m(l("p","forum__addinfo-block-p forum__addinfo-block-p--clickabe","Informacja prawna"),g=l("span","forum__addinfo-block--notice-ico"))),i=l("div","forum__addinfo-block--notice-text","Redakcja INTERIA.PL nie ponosi odpowiedzialności za treść wypowiedzi zawartych w komentarzach użytkowników. Ponadto redakcja INTERIA.PL zastrzega sobie prawo do zablokowania dostępu do dodanego przez Użytkownika komentarza, w szczególności w związku z otrzymaniem wiarygodnej informacji lub urzędowego zgłoszenia w zakresie niezgodności komentarza z obowiązującymi przepisami prawa lub też w związku z zamieszczeniem treści naruszających normy obyczajowe, wzywających do nienawiści rasowej, etnicznej, wyznaniowej, propagujących przemoc czy naruszających zasady współżycia społecznego.")));n(f,"click",function(){k(g,"forum__addinfo-block--notice-ico--up"),k(i,"forum__addinfo-block--notice-text--opened")}),b(5),n(e,"click",function(){q||(q=!0,iwa("trackEvent","Komentarze","-","klik",o.getForum().getDsgUserType(),"zobacz_swoj"),h(e,r),o.getForum().changePage(0,a).then(function(){j(e,r),o.remove()}).catch(function(){q=!1,j(e,r)}))}),n(c,"click",function(){o.remove()}),this.dom.inside=p(this.dom.inside,s)},renderErrorMessage:function(a,b){var c;if(c=null===a?l("div"):l("div","forum__add-error-message",a),!0===b)return void(this.dom.errorMessage.innerHTML=this.dom.errorMessage.innerHTML+"<hr />"+a);this.dom.errorMessage=p(this.dom.errorMessage,c)},showRestrictions:function(){var a=this._forum.getReCaptchaApi();a.isRequired()?(a.show(),a.isRender()||a.reset()):a.hide()},render:function(){var a=this
;return this.dom.instance=m(l("div","forum__add"),m(this.dom.inside=l("div","forum__add-inside"),m(l("div","forum__add-top"),this.renderUser(),this.renderLinks()),m(l("div","forum__add-content"),m(l("div","forum__add-nohate-container"),l("div","forum__add-nohate-ico",'<svg x="0" y="0" viewBox="0 0 57 29" xml:space="preserve"><path d="M31.965149 11.521423c.534302-.41278.801391-.977905.801391-1.695312 0-.483215-.10907-.876099-.326904-1.179016-.217956-.302857-.570068-.519287-1.056091-.648865v-.0542c.368042-.090026.664734-.291991.889892-.60559.22522-.31372.337647-.692322.337647-1.135803 0-.674133-.258118-1.170715-.774414-1.489807-.51654-.319214-1.30719-.478638-2.372131-.478638h-2.733704v7.906433h3.050049c.921997 0 1.650085-.20642 2.184265-.619202zm-3.117005-5.670288h.59491c.664734 0 .997131.221802.997131.665161 0 .24884-.083007.43634-.249206.56244-.166199.126281-.401245.189392-.704895.189392h-.63794V5.851135zm0 4.640076V8.830994h.702088c.335998 0 .59253.070312.769348.210815.17688.140686.265259.34259.265259.605835 0 .5625-.330567.843567-.9917.843567h-.744995zm9.38379-.09198h-2.5354V8.906616h2.3479V7.192444h-2.3479V5.948547h2.5354V4.234192h-4.65265v7.906433h4.65265v-1.741394zm6.408996.016296h-3.478943l3.39325-4.867187V4.234192h-5.939392V5.95929h3.312683l-3.393067 4.861755v1.31958h6.10547v-1.725098zm-13.321594 6.6026h-2.46045v-2.931213h-2.128051v7.906433h2.128052v-3.223144h2.460449v3.223144h2.128052v-7.906433h-2.128052v2.931213zm7.925903 3.233765h-2.535583v-1.492554h2.347778v-1.714233h-2.347778v-1.243896h2.535583v-1.714295h-4.652893v7.906433h4.652893v-1.741455zm.866211 1.152039c0 .515564-.075073.879577-.22522 1.092407-.150085.212707-.400146.319092-.750366.319092-.150085 0-.289428-.01349-.418213-.040528-.128479-.02716-.250122-.051513-.364502-.073059V24.362c.34668.075744.712891.113708 1.099.113708.929016 0 1.625793-.275085 2.090515-.824707.464477-.549988.696777-1.360168.696777-2.43097v-7.133117h-2.12799v7.317017zm2.699402-5.57019h1.913819v6.159606h2.117187V15.83374h1.908386v-1.746826h-5.939392v1.746826zm11.056519-1.746827v4.629334c0 .56958-.097535.979675-.292298 1.230285-.194824.250488-.508423.375672-.940735.375672-.403808 0-.70935-.126099-.916565-.378357-.207397-.252442-.310913-.65802-.310913-1.216858v-4.640076h-2.12799v4.807678c0 1.034851.286682 1.827942.86029 2.379456.573609.551697 1.39441.827453 2.463074.827453 1.093506 0 1.930603-.283874 2.511352-.851684.580567-.56781.870972-1.369019.870972-2.403809v-4.759094h-2.117187zM10.143066 27.9917C4.88086 27.992186.625 23.776854.625 18.59619L.629394 8.024414c.003907-1.533691 1.26416-2.449219 2.479981-2.449219.375488.000489.748047.086426 1.084473.24463v-1.58252c.003906-1.533203 1.263672-2.44873 2.479492-2.44873.446289.000488.887695.120605 1.268555.339355C8.342285 1.138672 9.33203.625 10.237793.625c.625488.000488 1.242676.237793 1.697754.651367.504883.458985.782227 1.100586.780273 1.806153v.010742c.901856-.427246 2.056153-.257324 2.783692.402832.50586.460449.783203 1.10205.78125 1.80664v8.973145l.125-.39209c.576172-1.788086 2.38916-2.39746 3.807617-1.95166.654785.206055.682617.214844.694336.21875l.223144.069336c.175293.054687.32422.17871.408692.339355.086425.164551.103027.35254.046875.530274l-2.714356 8.450195c-1.196777 3.714844-4.717285 6.340332-8.722656 6.45166h-.006348zm-8.125488-9.328614c.038086 4.353515 3.617188 7.899414 8.015625 7.946289l.080566-.002441c3.430176-.092286 6.442872-2.348145 7.48584-5.61377l.357422.114258-.356445-.116211 2.447265-7.659668-.25293-.079102c-.7583-.23828-1.739745.050293-2.06201 1.05127l-1.539063 4.761719c-.020508.03662-.04834.08252-.089356.128906l-.07959.076172c-.047363.035156-.07666.054687-.10791.0708l-.114258.05127c-.042968.013184-.080078.020508-.117187.026856l-.160156.012207-.018555-.00586c-.908692-.043945-3.569824.015137-5.355957 2.211426-.236817.295899-.674805.345215-.97461.106934-.145996-.114258-.23828-.279785-.258789-.464356-.020996-.185058.032715-.367187.149903-.512207 1.850097-2.276855 4.463867-2.684082 5.819336-2.729004V5.300293c.000488-.32129-.109375-.584473-.327149-.781738-.20166-.183106-.47705-.288086-.75586-.288574-.436523 0-1.084472.282714-1.088867 1.062011v10.396485c0 .381836-.3125.692382-.696289.692382s-.696289-.310546-.696289-.692382V3.080078c.000977-.321289-.108886-.583496-.327148-.781738-.206543-.1875-.479492-.294922-.776856-.288574-.287109 0-.569335.112304-.764648.30371-.197266.192872-.302246.456543-.303223.762207V15.59375c0 .382324-.3125.69336-.696289.69336s-.696288-.311036-.696288-.69336V4.24414c.000976-.321777-.109375-.584472-.327149-.78125-.20166-.183593-.47705-.288574-.756348-.289062-.4375 0-1.085937.283692-1.088378 1.06543v11.464844c0 .381836-.3125.692382-.69629.692382-.384277 0-.696777-.310546-.696777-.692382V8.026367c-.000488-.318848-.110352-.580078-.327148-.776855-.20166-.183106-.477051-.288086-.75586-.288575-.4375 0-1.086914.283692-1.088867 1.06543l-.003418 10.636719zm7.632813 2.57666s0 .000488-.000489.000488l.000489-.000488zM4.751465 7.191894c.030762.061036.05957.126465.084473.19629v-.11963l-.084473-.07666zm7.3208-2.637206v.098632c.019532-.055176.041993-.108398.065919-.160156l-.065918.061523zM8.354493 3.483887c.016113.03662.031738.074707.045899.114257l-.045899-.114257z"/></svg>'),l("div","forum__add-nohate-ico-mobi",'<svg x="0" y="0" viewBox="0 0 31 55" xml:space="preserve"><path d="M11.234314 40.666473c.534302-.41278.801392-.977905.801392-1.695312 0-.483215-.10907-.876099-.326905-1.179016-.217956-.302857-.570068-.519287-1.056091-.648865v-.0542c.368042-.090026.664734-.291991.889893-.60559.22522-.31372.337646-.692322.337646-1.135803 0-.674133-.258118-1.170715-.774414-1.489807-.51654-.319214-1.30719-.478638-2.372131-.478638H6v7.906433h3.050049c.921997 0 1.650085-.20642 2.184265-.619202zM8.11731 34.996185h.59491c.664733 0 .99713.221802.99713.665161 0 .24884-.083007.43634-.249206.56244-.166199.126281-.401245.189392-.704895.189392h-.63794v-1.416993zm0 4.640076v-1.660217h.702087c.335998 0 .59253.070312.769348.210815.17688.140686.265259.34259.265259.605835 0 .5625-.330566.843567-.9917.843567H8.11731zm9.383789-.09198h-2.5354v-1.492615h2.3479v-1.714172h-2.3479v-1.243897h2.5354v-1.714355h-4.65265v7.906433h4.65265v-1.741394zm6.408996.016296h-3.478943l3.39325-4.867187v-1.314148H17.88501v1.725098h3.312683l-3.393067 4.861755v1.31958h6.10547v-1.725098zm-18.321594 6.6026h-2.46045v-2.931213H1v7.906433h2.128052v-3.223144H5.5885v3.223144h2.128052v-7.906433H5.5885v2.931214zm7.925903 3.233765h-2.535583v-1.492554h2.347778v-1.714233h-2.347778v-1.243896h2.535583v-1.714295H8.861511v7.906433h4.652893v-1.741455zm.866211 1.152039c0 .515564-.075073.879577-.22522 1.092407-.150085.212707-.400146.319092-.750366.319092-.150085 0-.289428-.01349-.418213-.040528-.128479-.02716-.250122-.051513-.364502-.073059v1.660157c.34668.075744.712891.113708 1.099.113708.929016 0 1.625793-.275085 2.090515-.824707.464477-.549988.696777-1.360168.696777-2.43097v-7.133117h-2.12799v7.317017zm2.699402-5.57019h1.913818v6.159606h2.117188V44.97879h1.908386v-1.746826h-5.939392v1.746826zm11.056519-1.746827v4.629334c0 .56958-.097535.979675-.292298 1.230285-.194824.250489-.508423.375672-.940735.375672-.403808 0-.70935-.126099-.916565-.378357-.207397-.252442-.310913-.65802-.310913-1.216858v-4.640076h-2.12799v4.807678c0 1.034851.286682 1.827942.86029 2.379456.573609.551697 1.39441.827454 2.463074.827454 1.093506 0 1.930603-.283875 2.511352-.851685.580567-.56781.870972-1.369019.870972-2.403809v-4.759094h-2.117187zM14.647878 27.9917c-5.262207.000487-9.518067-4.214845-9.518067-9.395509l.004395-10.571777c.003906-1.533691 1.26416-2.449219 2.47998-2.449219.375489.000489.748047.086426 1.084473.24463v-1.58252c.003906-1.533203 1.263672-2.44873 2.479492-2.44873.44629.000488.887695.120605 1.268555.339355C12.847096 1.138672 13.836842.625 14.742604.625c.625489.000488 1.242676.237793 1.697755.651367.504883.458985.782227 1.100586.780274 1.806153v.010742c.901855-.427246 2.056152-.257324 2.783691.402832.50586.460449.783203 1.10205.78125 1.80664v8.973145l.125-.39209c.576172-1.788086 2.38916-2.39746 3.807617-1.95166.654785.206055.682617.214844.694336.21875l.223145.069336c.175293.054687.324218.17871.408691.339355.086426.164551.103027.35254.046875.530274l-2.714356 8.450195c-1.196777 3.714844-4.717285 6.340332-8.722657 6.45166h-.006347zm-8.125489-9.328614c.038086 4.353515 3.617188 7.899414 8.015625 7.946289l.080567-.002441c3.430176-.092286 6.442872-2.348145 7.48584-5.61377l.357423.114258-.356446-.116211 2.447266-7.659668-.25293-.079102c-.7583-.23828-1.739746.050293-2.062012 1.05127L20.69866 19.06543c-.020508.03662-.04834.08252-.089356.128906l-.07959.076172c-.047363.035156-.07666.054687-.10791.0708l-.114257.05127c-.04297.013184-.080078.020508-.117188.026856l-.160156.012207-.018555-.00586c-.908691-.043945-3.569824.015137-5.355958 2.211426-.236816.295899-.674805.345215-.97461.106934-.145995-.114258-.23828-.279785-.258788-.464356-.020996-.185058.032714-.367187.149902-.512207 1.850098-2.276855 4.463868-2.684082 5.819337-2.729004V5.300293c.000488-.32129-.109375-.584473-.327149-.781738-.20166-.183106-.47705-.288086-.755859-.288574-.436523 0-1.084473.282714-1.088867 1.062011v10.396485c0 .381836-.3125.692382-.69629.692382s-.69629-.310546-.69629-.692382V3.080078c.000977-.321289-.108886-.583496-.327148-.781738-.206543-.1875-.479492-.294922-.776855-.288574-.28711 0-.569336.112304-.764649.30371-.197265.192872-.302246.456543-.303222.762207V15.59375c0 .382324-.3125.69336-.69629.69336s-.696288-.311036-.696288-.69336V4.24414c.000976-.321777-.109375-.584472-.327149-.78125-.20166-.183593-.47705-.288574-.756348-.289062-.4375 0-1.085937.283691-1.088378 1.06543v11.464844c0 .381836-.3125.692382-.69629.692382-.384277 0-.696777-.310546-.696777-.692382V8.026367c-.000488-.318848-.110351-.580078-.327148-.776855-.20166-.183106-.47705-.288086-.75586-.288575-.4375 0-1.086914.283692-1.088867 1.06543L6.52239 18.663086zm7.632813 2.57666s0 .000488-.000488.000488l.000488-.000488zM9.256276 7.191894c.030762.061036.05957.126465.084473.19629v-.11963l-.084473-.07666zm7.320802-2.637206v.098632c.019531-.055176.041992-.108398.065918-.160156l-.065918.061523zm-3.717775-1.070801c.016114.03662.031739.074707.045899.114257l-.045898-.114257z"/></svg>'),l("div","forum__add-nohate-content",'Grupa Interia.pl przeciwstawia się niestosownym, nasyconym nienawiścią komentarzom, niezależnie od wyrażanych poglądów. Jeśli widzisz komentarz, który jest hejtem – <a class="forum__add-nohate-link" href="https://firma.interia.pl/kontakt?serwname=forum" target="_blank">wyślij nam zgłoszenie.</a>')),this.dom.contentInput=l("textarea","forum__add-content-input","",{placeholder:"WPISZ KOMENTARZ"}),this.dom.errorMessage=l("div"),this.renderAttachmentList()),m(l("div","forum__add-recaptcha",null,{style:"display: none;"}),this.dom.reCaptcha=l("div")),m(l("div","forum__add-bottom"),this.dom.attachmentMessage=this.renderAttachmentMessage(),this.dom.submit=l("a","forum__add-bottom-submit","Dodaj komentarz",{href:"#",title:"Dodaj komentarz"})))),n(this.dom.submit,"click",function(b){var c;b.preventDefault(),a.checkForm()&&(c=a.getUser(),c.isLogged()||c.setNick(a.dom.inputNick.value),a._abortAttachmentListRequest(),a.send())}),this.dom.contentInput&&n(this.dom.contentInput,"focus",function(){a.showRestrictions()}),this.dom.inputNick&&n(this.dom.inputNick,"focus",function(){a.showRestrictions()}),this.watchField(this.dom.contentInput),void 0!==this.getForum()._reCaptchaApi&&this.getForum().reloadReCaptcha(),this.dom.instance},watchField:function(a){var b=this;n(a,"input keyup contextmenu cut",f(function(){var a=b._prepareParsedLinks(b._parseContent(this.value));b.updateAttachmentList(b.getParsedLinkList(),a)&&(b.removeTryTimer(),b._tryNumber=1,b._linkList=a,b.sendAttachmentList(a))},1e3)),n(a,"input keyup contextmenu cut",function(c){return this.value.length>R.user.contentMaxLength?(c.preventDefault(),P.show(a,"bottom",5e3,!1,"Osiągnąłeś maksymalną długość komentarza ("+R.user.contentMaxLength+" znaków)."),this.value=this.value.substring(0,R.user.contentMaxLength),!1):(b.autoHeightField(a),!0)})},autoHeightField:function(a){a.style.height="auto";var b=a.scrollHeight;a.style.height=b+"px"},_isLinkListChanged:function(a,b){return a.length!==b.length||JSON.stringify(a)!==JSON.stringify(b)},_parseContent:function(a){for(var b,c=/(((https?:\/\/)|(www\.))[^\s]+\.[^\s]{2,})/g,d=[];b=c.exec(a);)d.push(b[0]);return d},_prepareParsedLinks:function(a){return this._removeDuplicates(a).slice(0,R.api.attachmentLimitNumber)},_removeDuplicates:function(a){return a.filter(function(b,c){return a.indexOf(b)===c})},_abortAttachmentListRequest:function(){null!==this._attachmentRequest&&this._attachmentRequest.abort()},sendAttachmentList:function(a){var b=this;0!==a.length&&(this._abortAttachmentListRequest(),this._attachmentRequest=this.getForum().getApi().addAttachmentList(a).then(function(a,c){b.fillDataAttachmentList(b._checkAttachmentListResponse(c))}).catch(function(a){}))},findAttachmentByOriginalUrl:function(a){var b=this._attachmentList.filter(function(b){return b.getOriginalUrl()===a});return b.length>0?b[0]:null},updateAttachmentList:function(a,b){var c=this;return!!this._isLinkListChanged(a,b)&&(this._attachmentList.forEach(function(a,d){-1===b.indexOf(a.getOriginalUrl())&&c._attachmentList.splice(d,1)}),b.forEach(function(b){-1===a.indexOf(b)&&c._attachmentList.push(new G(c,b))}),this.renderAttachmentList(),!0)},fillDataAttachmentList:function(a){var b,c=this;a.forEach(function(a){a.originalUrl&&(b=c.findAttachmentByOriginalUrl(a.originalUrl))instanceof G&&b.fillData(a)}),this.renderAttachmentList()}}),G.prototype=u(G.prototype,{fillData:function(a){this._proxyUrl=w(a.proxyUrl,null),this._thumbId=w(a.thumbId,null),this._thumbExtension=w(a.thumbExtension,null),this._type=w(a.type,null),this._errorCode=w(a.errorCode,null),this._errorMessage=w(a.errorMessage,null)},getOriginalUrl:function(){return this._originalUrl},getFormAdd:function(){return this._formAdd},getType:function(){return this._type},getThumbId:function(){return this._thumbId||null},getThumbExtension:function(){return this._thumbExtension||null},getThumbUrl:function(){return null!==this.getThumbId()?this.getFormAdd().getForum().getAttachmentImage().makeUrl(this.getThumbId(),this.getThumbExtension(),{small:"C416"}):null},hasError:function(){return 0!==this.getErrorCode()},getErrorCode:function(){return this._errorCode},getErrorMessage:function(){return this._errorMessage},remove:function(){this.getFormAdd().removeAttachmentAdd(this)},checkHasThumb:function(){null===this.getThumbUrl()&&(this._notFoundThumb=!0)},renderThumb:function(){var a=this.getThumbUrl(),b=this;return m(l("div","forum__add-file-thumb"),function(){return null!==a?[l("div","forum__add-file-thumb-ico forum__add-file-thumb-ico--"+b.getType()),l("img","forum__add-file-thumb-img",null,{src:a})]:!0===b._notFoundThumb?l("div","forum__add-file-thumb-notfound"):l("div","forum__add-file-thumb-preloader")}(),this.dom.removeButton=l("div","forum__add-file-remove","Usuń"))},render:function(){var a=this;return this.dom.instance=m(l("div","forum__add-file"),this.renderThumb()),n(this.dom.removeButton,"click",function(){a.remove()}),this.dom.instance}}),H.prototype=u(H.prototype,{isRendered:function(){return null!==this.dom.instance},getInstanceDom:function(){return this.dom.instance},getForum:function(){return this._forum},getComment:function(){return this._comment},getSmsCode:function(){return this.dom.smsCode&&this.dom.smsCode.value?this.dom.smsCode.value:null},toggleShow:function(){this.isRendered()&&k(this.dom.instance,"forum__premiumform--hidden")},send:function(){var a=this,b=this.getForum().getApi();this.showPreloader(),b.getCsrfToken(this.getComment().getId()).then(function(c,d){return b.promote(d.result.csrf,a.getComment().getId(),a.getSmsCode()).then(function(b,c){a.sendResult(c),a.hidePreloader()})}).catch(function(b){a.hidePreloader(),a.renderErrorMessage("Serwer nie odpowiada - spróbuj ponownie za chwilę.")})},sendResult:function(a){a&&0===a.errorCode?(iwa("trackEvent","Komentarze","-","klik",this.getForum().getDsgUserType(),"wyroznij_ok"),this.renderCorrectMessage()):this.renderErrorMessage(a.errorMessage)},showPreloader:function(){h(this.dom.submit,"forum__premiumform-submit--loading")},hidePreloader:function(){j(this.dom.submit,"forum__premiumform-submit--loading")},renderCorrectMessage:function(){var a,b=this,c=!1,d="forum__premiumform-correct-button--loading",e=m(l("div"),l("div","forum__premiumform-correct-message","Wypromowano komentarz"),a=l("a","forum__premiumform-correct-button","Zobacz",{href:"#"}));n(a,"click",function(e){e.preventDefault(),c||(c=!0,h(a,d),b.getForum().changePage(0,b.getComment().getId()).then(function(){j(a,d)}).catch(function(){c=!1,j(a,d)}))}),this.dom.content=p(this.dom.content,e),this.getForum().scrollToElement(this.getInstanceDom())},renderErrorMessage:function(a){var b=l("div","forum__premiumform-error-message",a);this.dom.errorMessage=p(this.dom.errorMessage,b)},render:function(){var a=this;return this.dom.instance=m(l("div","forum__premiumform"),this.dom.closeButton=l("div","forum__premiumform-close"),this.dom.content=m(l("div"),l("h3","forum__premiumform-header","Wyróżnij ten komentarz spośród pozostałych, niech zobaczą go wszyscy!"),l("p","forum__premiumform-text","Aby wyróżnić ten komentarz wyślij sms o treści  <b>KOLOR</b> na numer"),l("p","forum__premiumform-phone-number","7271"),l("p","forum__premiumform-text","I wpisz otrzymany kod w polu poniżej"),m(l("div","forum__premiumform-form"),this.dom.smsCode=l("input","forum__premiumform-input",null,{type:"text",name:"smsCode"}),this.dom.submit=l("input","forum__premiumform-submit",null,{type:"submit",value:"ok"})),this.dom.errorMessage=l("div"),m(l("div","forum__premiumform-notes"),l("span","forum__premiumform-note","Koszt całkowity SMS 2.46 PLN"),l("a","forum__premiumform-note forum__premiumform-note--link","Nota prawna",{href:R.url.premiumLaw,target:"_blank"}),l("a","forum__premiumform-note forum__premiumform-note--link","O co chodzi z wyróżnieniem",{href:R.url.premiumInfo,target:"_blank"})))),n(this.dom.submit,"click",function(){a.send()}),n(this.dom.closeButton,"click",function(){iwa("trackEvent","Komentarze","-","klik",a.getForum().getDsgUserType(),"wyroznij_x"),a.toggleShow()}),this.dom.instance}}),I.prototype=u(I.prototype,new x(["render","filterSelectChange","sortSelectChange","remove"]),{getOptions:function(){return this._options},getObjectId:function(){return this.settings.objectId},getObjectType:function(){return this.settings.objectType},getProfileServiceId:function(){return this.settings.profileServiceId},getMailServiceId:function(){return this.settings.mailServiceId},getContainerDom:function(){return this.settings.containerDom},getListToScroll:function(){return this.dom.commentListPremium||this.dom.commentList},getStorage:function(){return this._storage},allowLoginUser:function(){return this.settings.allowLoginUser},getInstanceDom:function(){return null===this.dom.instance&&(this.dom.instance=l("div","forum "+this.settings.themeList[this._actualThemeIndex].css)),this.dom.instance},remove:function(){this.fire("remove"),this.abortAllChangePageReqest(),this._stopListenResize(),this._stopListenScroll(),this.getContainerDom().removeChild(this.getInstanceDom())},getActualPageNumber:function(){return this._actualPageNumber},setActualPageNumber:function(a){this._actualPageNumber=a},getPlaceName:function(){return this.settings.placeName},getUrl:function(a){var b={forumPlaceName:this.getPlaceName()};return a&&(b.forumCommentId=a),Q.makeUrl(b)},getCommentIdFromUrl:function(){return this.settings.placeName===Q.getParam("forumPlaceName")&&Q.getParam("forumCommentId")>0?parseInt(Q.getParam("forumCommentId"),10):null},getSortValue:function(){return this.settings.sortValue},setSortValue:function(a){this.settings.sortValue=a},getSortValueName:function(){var a=this.getSortValue();return this.settings.sort.find(function(b){return Number(b.value)===Number(a)}).name},getFilterValue:function(){return this.settings.filterValue},setFilterValue:function(a){this.settings.filterValue=a},getPackSize:function(){return this.settings.packSize},getActualCssClassIndex:function(){return this._actualThemeIndex},getActualThemeParams:function(){return this.settings.themeList[this.getActualCssClassIndex()]},getToken:function(){return this.settings.token},setToken:function(a){this.settings.token=a},getTokenTimestamp:function(){return this.settings.tokenTimestamp},setTokenTimestamp:function(a){this.settings.tokenTimestamp=a},getScreenToken:function(){return this.settings.screenToken},setScreenToken:function(a){this.settings.screenToken=a},getLoginUrl:function(){return this.settings.loginUrl},getLogoutUrl:function(){return this.settings.logoutUrl},getProfileSettingsUrl:function(){return this.settings.profileSettingsUrl},getProfileActivateUrl:function(){return this.settings.profileActivateUrl},isMobileApp:function(){return this.settings.isMobileApp},getVisitingCommentId:function(){return this._visitingCommentId},getDsgUserType:function(){return this.settings.dsgUserType},getApi:function(){return this._api instanceof a||(this._api=new a(this,{objectId:this.getObjectId(),objectType:this.getObjectType()})),this._api},getPagination:function(){return this._pagination instanceof K||(this._pagination=new K(this)),this._pagination},getFormAdd:function(){return this._formAdd instanceof F||(this._formAdd=new F(this,this.getUser())),this._formAdd},getReCaptchaApi:function(){return this._reCaptchaApi instanceof c||(this._reCaptchaApi=new c),this._reCaptchaApi},reloadFormAdd:function(){delete this._formAdd,this._formAdd=null,this.dom.formAdd=p(this.dom.formAdd,this.getFormAdd().render())},getUser:function(){return this._user instanceof L||(this._user=new L(this)),this._user},getAttachmentImage:function(){return this._attachmentImage instanceof d||(this._attachmentImage=new d(this,this.settings.themeList,this.settings.imageServerHost)),this._attachmentImage},changePagePending:function(){return this._changePagePromise.length>0},addChangePageReqest:function(a){this._changePagePromise.push(a)},removeChangePageReqest:function(a){var b=this._changePagePromise.indexOf(a);b>-1&&this._changePagePromise.splice(b,1)},abortAllChangePageReqest:function(){0!==this._changePagePromise.length&&(this._changePagePromise.forEach(function(a){a.abort()}),this._changePagePromise=[])},scrollToElement:function(a,b,c){var d,e,f;a&&"function"==typeof a.getBoundingClientRect&&(d=a.getBoundingClientRect(),b=w(b,0),e=document.documentElement,f=(window.pageYOffset||e.scrollTop)-(e.clientTop||0),O.scrollToPosition(f+d.top+this.settings.scrollTopOffset+b,c))},changePage:function(a,b,c){var d=null===a?this.getActualPageNumber():a,e=void 0===b?null:b,f=this,g=this.getApi().getCommentList(d,this.getFilterValue(),this.getSortValue(),e,this.getPackSize());return this.addChangePageReqest(g),g.then(function(a,b){null===f._reCaptchaApi&&b&&b.result&&b.result.reCaptchaConfig&&f.initReCaptcha(b.result.reCaptchaConfig),f.removeChangePageReqest(g),f.render(f.parseCommentListData(f.updateTokens(b))),setTimeout(function(){f._scrollAfterRender(b,c)},0)}).catch(function(a){}),g},getCommentList:function(){return this._commentList},getCommentListPremium:function(){return this._commentListPremium},getCommentById:function(a){var b;return b=this.getCommentListPremium().filter(function(b){return b.getId()===a}),1===b.length?b[0]:(b=this.getCommentList().filter(function(b){return b.getId()===a}),1===b.length?b[0]:null)},_instanceComment:function(a,b){var c,d,e,f=[],g=this.getStorage()._getInstanceData();for(c=0;c<a.length;c+=1)d=a[c],g&&g.voted&&g.voted[d.id]?(e=g.voted[d.id],g.voted[d.id+"-up"]&&d.voteup<g.voted[d.id+"-up"]&&(d.voteup=g.voted[d.id+"-up"]),g.voted[d.id+"-down"]&&d.votedown<g.voted[d.id+"-down"]&&(d.votedown=g.voted[d.id+"-down"])):e=null,d=u(d,{voteStatus:e}),f.push(new C(this,this.getUser(),d,b));return f},parseCommentListData:function(a){var b;return a&&a.result&&a.result.commentList?(b=a.result,this.setActualPageNumber(b.commentListPageNumber),this._commentList=b.commentList=this._instanceComment(b.commentList),this._commentListPremium=b.commentListPremium=this._instanceComment(b.commentListPremium),this._visitingCommentId=b.visitingCommentId,b):null},updateTokens:function(a){return a?(a.token&&this.setToken(a.token),a.ts&&this.setTokenTimestamp(a.ts),a.screenToken&&this.setScreenToken(a.screenToken),a):null},renderCommentList:function(a){return m(l("div","forum__list"),function(){return a.map(function(a){return a.render()})}())},renderCommentListPremium:function(a){return 0===a.length?l("div","forum__premium"):m(l("div","forum__premium"),l("div","forum__premium-header","Najczęściej wyróżniane"),h(this.renderCommentList(a),"forum__list--premium"))},renderSortSelect:function(){var a=this,b=m(l("div","forum__filter-container forum__filter-container--order"),m(l("span","forum__filter-select"),m(this.dom.sortSelect=l("select",null,null,{name:"sort"}),function(){return a.settings.sort.map(function(b){var c={value:b.value};return a.settings.sortValue===b.value&&(c.selected="selected"),l("option",null,b.name,c)})}())));return n(this.dom.sortSelect,"change",function(){var b={1:"najnowsze",2:"najstarsze",3:"najlepiej_oceniane",4:"wg_liczby_odp"};b.hasOwnProperty(this.value)&&iwa("trackEvent","Komentarze","-","sortuj",a.getDsgUserType(),b[this.value]),a.setSortValue(this.value),a.fire("sortSelectChange"),a.dom.filterToggle.innerText=a.getSortValueName(),a.changePage(0)}),b},renderFilterSelect:function(){var a=this,b=m(l("div","forum__filter-container forum__filter-container--filter"),m(l("span","forum__filter-select"),m(this.dom.filterSelect=l("select",null,null,{name:"filter"}),function(){return a.settings.filter.map(function(b){var c={value:b.value};return a.settings.filterValue===b.value&&(c.selected="selected"),l("option",null,b.name,c)})}())));return n(this.dom.filterSelect,"change",function(){var b={all:"wszyscy",logged:"zalogowani",promoted:"wyroznione"};b.hasOwnProperty(this.value)&&iwa("trackEvent","Komentarze","-","sortuj",a.getDsgUserType(),b[this.value]),a.setFilterValue(this.value),a.fire("filterSelectChange"),a.changePage(0)}),b},_renderNotFoundComment:function(a){return m(l("div","forum__notfound"),l("div","forum__notfound-info",a))},_renderStructure:function(){var a=this;m(this.getInstanceDom(),m(l("div","forum__top"),m(l("div","forum__header"),m(l("div","forum__header-label"),l("span","forum__header-label-text","Wasze komentarze"),this.dom.headerLabelCount=l("span","forum__header-label-count forum__header-label-count--loading","-")),this.dom.filterToggle=l("div","forum__header-filter-button",a.getSortValueName(),{title:"Zmień sposób sortowania komentarzy"})),m(this.dom.filterBlock=l("div","forum__filter"),this.renderFilterSelect(),this.renderSortSelect()),this.dom.formAdd=this.getFormAdd().render()),this.dom.notFoundComment=l("div"),this.dom.commentListPremium=this.renderCommentListPremium([]),this.dom.commentList=this.renderCommentList([]),m(l("div","forum__bottom"),this.dom.pagination=l("div"))),n(this.dom.filterToggle,"click",function(){g(a.dom.filterBlock,"forum__filter--open")?(j(a.dom.filterBlock,"forum__filter--open"),j(a.dom.filterToggle,"forum__header-filter-button--open")):(h(a.dom.filterBlock,"forum__filter--open"),h(a.dom.filterToggle,"forum__header-filter-button--open"))})},render:function(a){if(null===a)return!1;j(this.dom.headerLabelCount,"forum__header-label-count--loading"),this.dom.headerLabelCount.innerHTML="("+a.commentAllCount+")",this.replaceCommentList(a.commentList),this.replaceCommentListPremium(a.commentListPremium),this.getPagination().render(this.dom.pagination,a.commentListPageNumber,a.commentListPageCount),this.fire("render");var b=new CustomEvent("renderForum");return window.dispatchEvent(b),!0},replaceCommentList:function(a){this.dom.commentList=p(this.dom.commentList,this.renderCommentList(a))},replaceCommentListPremium:function(a){this.dom.commentListPremium=p(this.dom.commentListPremium,this.renderCommentListPremium(a))},refreshComments:function(){this.replaceCommentList(this.getCommentList()),this.replaceCommentListPremium(this.getCommentListPremium())},_scrollAfterRender:function(a,b){var c,d,e=this;if(this.dom.notFoundComment=p(this.dom.notFoundComment,l("div")),a.result.visitingCommentId>0)switch(a.result.visitingCommentStatus){case"accept":if(a.result.visitingMainCommentId===a.result.visitingCommentId)null!==(c=this.getCommentById(a.result.visitingCommentId))&&this.scrollToElement(c.getInstanceDom());else{if(null===(d=this.getCommentById(a.result.visitingMainCommentId)))return;d.showReplyList(a.result.visitingCommentId).then(function(){null!==(c=d.getReplyCommentById(a.result.visitingCommentId))&&e.scrollToElement(c.getInstanceDom())})}break;case"notfound":this.dom.notFoundComment=p(this.dom.notFoundComment,this._renderNotFoundComment("Szukany komentarz jest niedostępny.")),this.scrollToElement(this.dom.notFoundComment);break;case"deleted":this.dom.notFoundComment=p(this.dom.notFoundComment,this._renderNotFoundComment("Komentarz został usunięty ze względów regulaminowych.")),this.scrollToElement(this.dom.notFoundComment)}else b||this.scrollToElement(this.getListToScroll())},_listenResize:function(){this._resizeListener=e(this._resize.bind(this),200),window.addEventListener("resize",this._resizeListener)},_stopListenResize:function(){window.removeEventListener("resize",this._resizeListener)},_listenScroll:function(){this._scrollListener=f(this._scroll.bind(this),200),window.addEventListener("scroll",this._scrollListener),this._scrollListener()},_stopListenScroll:function(){window.removeEventListener("scroll",this._scrollListener)},_scroll:function(){this.getListToScroll().getBoundingClientRect().top<window.innerHeight&&(iwa("trackEvent","Komentarze","-","view",this.getDsgUserType(),"CommentZone"),this._stopListenScroll())},getInstanceWidth:function(){var a=this.getInstanceDom().getBoundingClientRect();return parseInt(a.width,10)},_resize:function(){var a=this.getInstanceWidth();a!==this._instanceWidth&&(this._instanceWidth=a,this.checkSize())},checkSize:function(){var a,b=this.settings.themeList,c=b.length,d=0;for(a=0;a<c&&this._instanceWidth>=b[a].from;a+=1)d=a;d!==this.getActualCssClassIndex()&&(j(this.getInstanceDom(),b[this.getActualCssClassIndex()].css),h(this.getInstanceDom(),b[d].css),this._actualThemeIndex=d)},initReCaptcha:function(a){var b=this.getReCaptchaApi();b.setDom(this.getFormAdd().dom.reCaptcha),b.setForum(this),b.setConfig(a),b.init()},reloadReCaptcha:function(){var a=this.getReCaptchaApi();a.setDom(this._formAdd.dom.reCaptcha),a.reload()}}),J.prototype=u(J.prototype,{_storageItemName:"forum4",_storageTimeMs:864e6,getForum:function(){return this._forum},getStorageItemName:function(){return this._storageItemName},_getWholeData:function(){var a={};try{if(null===(a=localStorage.getItem(this.getStorageItemName())))return{};a=JSON.parse(a)}catch(b){}return a},_saveWholeData:function(a){try{localStorage.setItem(this.getStorageItemName(),JSON.stringify(a))}catch(b){}},_getInstanceKey:function(){var a=this.getForum();return a.getObjectType()+"-"+a.getObjectId()},_getInstanceData:function(){var a=this._getWholeData(),b=this._getInstanceKey();return a&&a[b]?a[b]:{}},_saveInstanceData:function(a){var b=this._getWholeData();b[this._getInstanceKey()]=a,this._saveWholeData(b)},_removeOldData:function(){var a,b,c=(new Date).getTime(),d=!1;0===Math.floor(10*Math.random())&&(b=this._getWholeData(),Object.keys(b).forEach(function(e){(a=b[e])&&a.lastVoted&&a.lastVoted+this._storageTimeMs<c&&(delete b[e],d=!0)}),d&&this._saveWholeData(b))},saveCommentVote:function(a,b,c,d){var e=this._getInstanceData();e.hasOwnProperty("voted")||(e.voted={}),e.lastVoted=(new Date).getTime(),e.voted[a]=b,e.voted[a+"-up"]=d,e.voted[a+"-down"]=c,this._saveInstanceData(e)}}),K.prototype=u(K.prototype,{isRendered:function(){return null!==this.dom.instance},_renderArrayNumber:function(a,b){var c=this;return b.map(function(b){var d
;return d="d"===b?l("div","forum__pagination-dots","..."):l("div","forum__pagination-page "+(b==a?"forum__pagination-page--selected":""),b+1),n(d,"click",function(){c.getForum().changePagePending()||(t(c.getForum().isMobileApp(),"changePage"),c._showPaginationPreloader(d),c.getForum().changePage(b).then(function(){c._hidePaginationPreloader(d)}).catch(function(){c._hidePaginationPreloader(d)}))}),d})},_allowSpaceSize:function(a){var b=a.getBoundingClientRect(),c=b.width,d=this.getForum().getActualThemeParams().pagination;return c-=2*(d.naviBut+d.dots),Math.floor(c/d.pageBut)},_renderElements:function(a,b,c){function d(a,b){if(a>b)return[];for(var c=[];a<=b;)c.push(a),a++;return c}var e=this._allowSpaceSize(a),f=c-1,g=b,h=c-1-g,i=[];if(c<=e)return m(a,this._renderArrayNumber(b,d(0,f)));if(3==e)return 0===b?i=i.concat([0,1,"d",f]):1===b?i=i.concat([0,1,"d",f]):b===f-1?i=i.concat([0,"d",b,f]):b===f?i=i.concat([0,"d",f-1,f]):b>=2&&(i=i.concat([0,"d",b,"d",f])),m(a,this._renderArrayNumber(b,i));if(4==e)return 0===b?i=i.concat([0,1,2,"d",f]):1===b?i=i.concat([0,1,2,"d",f]):2===b?i=i.concat([0,"d",2,3,"d",f]):b===f-2?i=i.concat([0,"d",b-1,b,f]):b===f-1?i=i.concat([0,"d",b,f]):b===f?i=i.concat([0,"d",f-1,f]):b>=3&&(i=i.concat([0,"d",b,b+1,"d",f])),m(a,this._renderArrayNumber(b,i));var j=0;if(g<e/2)i=i.concat(d(0,g)),j=g;else{var k=Math.floor(b-(e-4)/2);j=b-k+1,i=i.concat([0,"d"],d(k,b))}if(h<=e-j-1)i=i.concat(d(f-h+1,f));else{var l=b+1,n=b+(e-j-2);i=l>n?i.concat([f]):i.concat(d(l,n),["d",f])}return m(a,this._renderArrayNumber(b,i))},_showPaginationPreloader:function(a){h(a,"has-preloader")},_hidePaginationPreloader:function(a){j(a,"has-preloader")},getForum:function(){return this._forum},_renderContainer:function(a,b){return m(l("div","forum__pagination"),this.dom.prev=l("a","forum__pagination-prev "+(0===a?"forum__pagination-prev--disabled":"forum__pagination-prev--active"),"Poprzednie",{href:"#"}),this.dom.next=l("a","forum__pagination-next "+(a===b-1?"forum__pagination-next--disabled":"forum__pagination-next--active"),"Następne",{href:"#"}),this.dom.pages=l("div","forum__pagination-pages"))},render:function(a,b,c){var d=this,e=this.getForum();return c<2?(this.isRendered()&&(this.dom.instance=p(this.dom.instance,l("div"))),null):(this.isRendered()?this.dom.instance=p(this.dom.instance,this._renderContainer(b,c)):m(a,this.dom.instance=this._renderContainer(b,c)),n(this.dom.next,"click",function(a){a.preventDefault(),b!==c-1&&(e.changePagePending()||(t(e.isMobileApp(),"changePage"),d._showPaginationPreloader(d.dom.next),e.changePage(e.getActualPageNumber()+1).then(function(){d._hidePaginationPreloader(d.dom.next)}).catch(function(){d._hidePaginationPreloader(d.dom.next)})))}),n(this.dom.prev,"click",function(a){a.preventDefault(),0!==b&&(e.changePagePending()||(t(e.isMobileApp(),"changePage"),d._showPaginationPreloader(d.dom.prev),e.changePage(e.getActualPageNumber()-1).then(function(){d._hidePaginationPreloader(d.dom.prev)}).catch(function(){d._hidePaginationPreloader(d.dom.prev)})))}),setTimeout(function(){d._renderElements(d.dom.pages,b,c)},0),this.dom.instance)}}),L.prototype=u(L.prototype,{_cookieNameTime:"ESID",_cookieNameProfile:"UPROFILE",_cookieNameEmail:"UEMAIL",_nick:null,_avatarId:null,_avatarExtension:null,_isLogged:!1,_isLoggedMail:!1,_allowPostDelete:!1,getForum:function(){return this._forum},getNick:function(){return this._nick},setNick:function(a){this._nick=a},getAvatarId:function(){return this._avatarId},setAvatarId:function(a){this._avatarId=a},getAvatarExtension:function(){return this._avatarExtension},setAvatarExtension:function(a){this._avatarExtension=a},parseCookie:function(){var a,b,c;if(M.is(this._cookieNameTime)&&M.is(this._cookieNameEmail)&&M.is(this._cookieNameProfile)&&(a=M.getRaw(this._cookieNameTime))&&a.match(/^[0-9]+$/)&&!(M.getInt(this._cookieNameTime)<=parseInt((new Date).getTime()/1e3,10))){try{b=JSON.parse(M.getDecode(this._cookieNameProfile))}catch(d){}if(b)return b[this.getForum().getProfileServiceId()]?(c=b[this.getForum().getProfileServiceId()],this.setIsLogged(),this.setNick(c.n),this.setAvatarId(c.a),void this.setAvatarExtension(c.e)):void(b[this.getForum().getMailServiceId()]&&this.setIsLoggedMail())}},getAvatarUrl:function(){return this.getForum().getAttachmentImage().makeUrl(this.getAvatarId(),this.getAvatarExtension(),{small:"C414"})},isLogged:function(){return this._isLogged},setIsLogged:function(){this._isLogged=!0},isLoggedMail:function(){return this._isLoggedMail},setIsLoggedMail:function(){this._isLoggedMail=!0},canDeletePosts:function(){return this._allowPostDelete},checkCanDeletePosts:function(){var a=this,b=this.getForum(),c=S(function(a){return a.catch=function(b){return a.then(null,b)},a});return b.getApi().checkAllowPostDelete().then(function(b,d){0===d.errorCode&&d&&d.result&&!0===d.result.allowPostDelete?(a._allowPostDelete=!0,c(!0,[d])):c(!1,[d])}).catch(function(a){c(!1,[a])}),c}})}();