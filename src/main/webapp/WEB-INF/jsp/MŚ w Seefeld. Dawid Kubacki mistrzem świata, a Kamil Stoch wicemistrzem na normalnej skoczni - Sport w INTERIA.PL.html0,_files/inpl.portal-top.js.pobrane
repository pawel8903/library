var jQueryVerValid="function"==typeof jQuery(".test").on;jQueryVerValid||(jQuery.fn.extend({on:function(a,b,c,d){"function"==typeof b?jQuery(this).live(a,b):jQuery(b).live(a,c)},off:function(a,b,c,d){jQuery(this).die(a)}}),jQuery.fn.outerHeight=function(){var a=0;return this.style&&(a=this.style.paddingTop+this.style.paddingBottom),this.height()+a});var console=console||{log:function(){}};!function(a,b,c,d){"use strict";function e(b,c){var d=this,e={initDelay:0,wrapperStart:'<div class="wrapper">',wrapperEnd:"</div>",headerText:"Najczęściej czytane",elementsListCssClass:"",elementCssClass:"col-xs-12 every-xs-1 col-rs-6 every-rs-2 col-sm-6 every-sm-2 col-md-6 every-md-2 col-lg-6 every-lg-2",renderLimit:6,elementHtmlRenderer:d._renderElement,elementsListHtmlRenderer:d._renderElementsList,headerHtmlRenderer:d._renderHeader,ajaxUrl:"",ajaxUrlActualIndex:0,ajaxTimeout:5e3,nPack:1,nPackUrlParamName:"nPack",nPackSize:8,uid:"",ref:"",cfg:"",imageServerUrl:"i.iplsc.com",thumbImageType:"C459",thumbImageFormat:"jpg"};d.element=b,d.settings=a.extend({},e,c),d._defaults=e,d._name=f,d.$window=null,d.isDomBlock=!1,d.dsgUserType="",d._iwaCount={view:!1},setTimeout(function(){d.init()},d.settings.initDelay)}var f="portalTop";a.extend(e.prototype,{init:function(){var a=this;a._initElements(),a._scrollLoader()},_initElements:function(){var c=this;c.$window=a(b),c.dsgUserType=Inpl&&Inpl.dsg&&Inpl.dsg.getUserType?Inpl.dsg.getUserType():"",c._setThumbImageType(),c.$elementsAppendPlace=a(c.settings.wrapperStart+c.settings.wrapperEnd),c.tileHeight=0},_setThumbImageType:function(){var a=this;a.settings.thumbImageType="has-theme-type-2"===a.settings.elementsListCssClass?"C469":"C459"},_ajaxData:function(){var a=this,b={};return b.uid=a.settings.uid,b.ref=a.settings.ref,b.cnt=a.settings.nPackSize,a.settings.cfg&&(b.cfg=a.settings.cfg),b},_ajaxUrl:function(){var b=this,c="";return a.isArray(b.settings.ajaxUrl)?c+=b.settings.ajaxUrl[b.settings.ajaxUrlActualIndex]:c+=b.settings.ajaxUrl,c+=","+b.settings.nPackUrlParamName+","+b.settings.nPack},_ajaxType:function(){return"GET"},_isOnScreen:function(a){var c=.8*this.tileHeight,d=a.getBoundingClientRect();return d.top+c<b.innerHeight&&d.bottom-c>0},_scrollLoader:function(){var a=this;jQueryVerValid||a.loadPortalTop(),a._isOnScreen(a.element)?a.loadPortalTop():a.$window.on("scroll.portalTop.start",function(){a.$window.scrollTop()>200&&(a.loadPortalTop(),a.$window.off("scroll.portalTop.start"))})},loadPortalTop:function(){var c=this;try{a.ajax({type:c._ajaxType(),url:"//"+b.location.hostname+c._ajaxUrl(),data:c._ajaxData(),dataType:"jsonp",jsonp:"callback",timeout:c.settings.ajaxTimeout}).done(function(b){1==b.status&&(c._renderHtml(b.data.items),c.settings.nPack+=b.data.nextPackId),a(c).removeClass("has-ajax-error")}).fail(function(a,b){})}catch(d){a(c).addClass("has-ajax-error")}},_appendHtml:function(b){var c=this;c.$elementsAppendPlace.append(b),c.$elementsAppendPlace.on("mousedown",".tile-magazine-thumb, .tile-magazine-title-url",function(b){var d=c.$elementsAppendPlace.find(".brief-list-item").index(a(this).parents(".brief-list-item"))+1;iwa("trackEvent","topka","-","klik",c.dsgUserType,"link_"+d)});var d=c.$elementsAppendPlace.find(".brief-list-item").eq(0);c.isDomBlock||(a(c.element).prepend(c.$elementsAppendPlace),c.tileHeight=d.outerHeight(),c.isDomBlock=!0),c._handleWhenOnScreen(c.element),c._bindScroll(),c._dispatchEventAfterElementAppended()},_renderHtml:function(a){var b=this,c="";a.length>0&&(c+=b.settings.headerHtmlRenderer(b.settings.headerText),c+=b.settings.elementsListHtmlRenderer(a,b)),b._appendHtml(c)},_makeUrl:function(a,b){return a&&""!==a?a+="?parametr=najczesciej_czytane&iwa_source=najczesciej_czytane":""},_makeImageUrl:function(a,b,c,d){var e=this;return d||"//"+e.settings.imageServerUrl+"/"+a+"-"+b+"."+c},_renderElement:function(a,b,c){var d="";d+='<li class="brief-list-item i'+c+" "+b.settings.elementCssClass+'">',d+='<div class="tile-magazine '+("article"!==a.type.toLowerCase()?a.type.toLowerCase():"")+'">';var e="";return a.attachment_ident||(e=" tile-magazine-nothumb"),d+='<a class="tile-magazine-thumb'+e+'" href="'+b._makeUrl(a.url)+'">',(a.attachment_ident||a.thumbnailUrl)&&(d+='<img src="'+b._makeImageUrl(a.attachment_ident,b.settings.thumbImageType,b.settings.thumbImageFormat,a.thumbnailUrl)+'" class="tile-magazine-img img-responsive" alt="'+a.title+'">'),d+="</a>",d+='<div class="tile-magazine-header">',a.category&&a.category.name&&a.category.url&&(d+='<a class="tile-magazine-category" href="'+a.category.url+'">'+a.category.name+"</a>"),d+='<h2 class="tile-magazine-title header-font"><a class="tile-magazine-title-url" href="'+b._makeUrl(a.url)+'" title="'+a.title+'">',a.title&&(d+=a.title),d+="</a></h2>",d+="</div>",d+="</div>",d+="</li>"},_renderElementsList:function(a,b){var c="",d=0;for(c+='<ul class="row '+b.settings.elementsListCssClass+'">';d<b.settings.renderLimit;d++)c+=b.settings.elementHtmlRenderer(a[d],b,d);return c+="</ul>"},_renderHeader:function(a){var b="";return b+='<div class="portal-top-header">',b+='<div class="portal-top-header-text">'+a+"</div>",b+="</div>"},throttle:function(a,b,c){b||(b=500);var d,e;return function(){var f=c||this,g=+new Date,h=arguments;d&&g<d+b?(clearTimeout(e),e=setTimeout(function(){d=g,a.apply(f,h)},b)):(d=g,a.apply(f,h))}},_dispatchEventAfterElementAppended:function(){var a=new CustomEvent("portalTopped");b.dispatchEvent(a)},_bindScroll:function(){var a=this;a.$window.on("scroll.portalTop touchmove.portalTop gesturechange.portalTop",a.throttle(function(){a._handleWhenOnScreen.call(a,this.element)},500,a))},_handleWhenOnScreen:function(a){this._isOnScreen(a)?0==this._iwaCount.view&&(iwa("trackEvent","topka","-","view",this.dsgUserType),this._iwaCount.view=!0):this._iwaCount.view=!1}}),a.fn[f]=function(b){var c=arguments;if(b===d||"object"==typeof b)return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))});if("string"==typeof b&&"_"!==b[0]&&"init"!==b){var g;return this.each(function(){var d=a.data(this,"plugin_"+f);d instanceof e&&"function"==typeof d[b]&&(g=d[b].apply(d,Array.prototype.slice.call(c,1)))}),g!==d?g:this}}}(jQuery,window,document);